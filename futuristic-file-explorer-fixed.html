<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeoExplorer - Explorador de Archivos Futurista</title>
    <style>
        :root {
            --primary-dark: #0a0e17;
            --secondary-dark: #131a29;
            --accent-color: #00c2ff;
            --accent-color-alt: #6e00ff;
            --text-color: #e6e6e6;
            --hover-color: rgba(0, 194, 255, 0.15);
            --glass-bg: rgba(19, 26, 41, 0.8);
            --glass-border: rgba(255, 255, 255, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: all 0.3s ease;
        }
        
        body {
            background-color: var(--primary-dark);
            color: var(--text-color);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .top-bar {
            background: var(--glass-bg);
            backdrop-filter: blur(8px);
            border-bottom: 1px solid var(--glass-border);
            padding: 10px 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 60px;
            z-index: 10;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            font-size: 1.2rem;
            color: var(--accent-color);
        }
        
        .logo span {
            background: linear-gradient(90deg, var(--accent-color), var(--accent-color-alt));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .search-bar {
            flex: 1;
            margin: 0 20px;
            position: relative;
        }
        
        .search-bar input {
            width: 100%;
            padding: 10px 15px 10px 40px;
            border-radius: 20px;
            border: 1px solid var(--glass-border);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-color);
            outline: none;
        }
        
        .search-bar input:focus {
            box-shadow: 0 0 5px var(--accent-color);
            border-color: var(--accent-color);
        }
        
        .search-bar::before {
            content: 'üîç';
            position: absolute;
            left: 15px;
            top: 10px;
            font-size: 16px;
        }
        
        .user-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-actions button {
            background: transparent;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            font-size: 1rem;
            padding: 8px 12px;
            border-radius: 4px;
        }
        
        .user-actions button:hover {
            background: var(--hover-color);
        }
        
        .user-profile {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--accent-color), var(--accent-color-alt));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
        }
        
        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .sidebar {
            width: 250px;
            background: var(--secondary-dark);
            padding: 15px;
            border-right: 1px solid var(--glass-border);
            overflow-y: auto;
            z-index: 5;
        }
        
        .sidebar-section {
            margin-bottom: 25px;
        }
        
        .sidebar-title {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.6);
        }
        
        .sidebar-item {
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sidebar-item:hover {
            background: var(--hover-color);
        }
        
        .sidebar-item.active {
            background: var(--hover-color);
            border-left: 3px solid var(--accent-color);
        }
        
        .content-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            position: relative;
        }
        
        .path-navigation {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px 15px;
            background: var(--glass-bg);
            backdrop-filter: blur(5px);
            border-radius: 8px;
            border: 1px solid var(--glass-border);
            flex-wrap: wrap;
        }
        
        .path-button {
            padding: 5px 10px;
            margin-right: 5px;
            background: transparent;
            border: none;
            cursor: pointer;
            border-radius: 4px;
            color: var(--text-color);
        }
        
        .path-button:hover {
            background: var(--hover-color);
        }
        
        .path-seperator {
            color: rgba(255, 255, 255, 0.4);
            margin: 0 5px;
        }
        
        .view-options {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .view-buttons {
            display: flex;
            gap: 10px;
        }
        
        .view-button {
            padding: 8px 12px;
            background: transparent;
            border: 1px solid var(--glass-border);
            border-radius: 4px;
            color: var(--text-color);
            cursor: pointer;
        }
        
        .view-button:hover, .view-button.active {
            background: var(--hover-color);
            color: var(--accent-color);
        }
        
        .sort-options select {
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 4px;
            color: var(--text-color);
            outline: none;
        }
        
        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .file-item {
            background: var(--glass-bg);
            backdrop-filter: blur(5px);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .file-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, transparent 0%, rgba(0, 194, 255, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .file-item:hover::before {
            opacity: 1;
        }
        
        .file-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--accent-color);
        }
        
        .file-name {
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .file-info {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 5px;
        }
        
        .status-bar {
            background: var(--glass-bg);
            backdrop-filter: blur(8px);
            border-top: 1px solid var(--glass-border);
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
            z-index: 10;
        }
        
        /* Animaciones y efectos */
        .glow {
            box-shadow: 0 0 10px var(--accent-color);
        }
        
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* Dise√±o responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
                overflow: visible;
            }
            
            .sidebar-item span, .sidebar-title {
                display: none;
            }
            
            .sidebar-item {
                justify-content: center;
            }
            
            .files-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
        }
        
        /* Efectos de part√≠culas de fondo */
        .particles-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }
        
        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--accent-color);
            border-radius: 50%;
            opacity: 0.5;
        }

        /* Estilos para modales y contexto */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(8px);
        }

        .context-menu {
            position: absolute;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            padding: 8px 0;
            min-width: 180px;
            z-index: 1000;
        }

        .context-item {
            padding: 8px 16px;
            cursor: pointer;
        }

        .context-item:hover {
            background: var(--hover-color);
        }

        .context-separator {
            height: 1px;
            background-color: var(--glass-border);
            margin: 4px 0;
        }

        .preview-content {
            width: 90%;
            max-width: 1200px;
            max-height: 90vh;
            background: var(--secondary-dark);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .preview-header {
            padding: 12px 20px;
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .preview-body {
            flex: 1;
            overflow: auto;
            padding: 20px;
        }

        .preview-close {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
        }

        /* Bot√≥n para abrir directorios */
        .open-directory-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-color), var(--accent-color-alt));
            color: white;
            font-size: 24px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 194, 255, 0.3);
            z-index: 900;
        }

        .open-directory-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 194, 255, 0.5);
        }

        /* Mensaje de compatibilidad */
        .compatibility-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 20px;
            max-width: 80%;
            text-align: center;
            z-index: 1001;
            display: none;
        }

        .compatibility-message h3 {
            margin-bottom: 15px;
            color: var(--accent-color);
        }

        .compatibility-message p {
            margin-bottom: 20px;
        }

        .compatibility-message button {
            padding: 8px 16px;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Input para seleccionar archivos */
        .file-input {
            display: none;
        }

        /* Notificaciones */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            border-radius: 5px;
            color: white;
            z-index: 9999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .notification.success {
            background-color: rgba(0, 194, 255, 0.8);
        }

        .notification.error {
            background-color: rgba(255, 0, 0, 0.8);
        }

        /* Vista de carga */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(0, 194, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Estilo de lista de archivos */
        .files-list {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .file-list-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-radius: 8px;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
        }

        .file-list-item .file-icon {
            margin-right: 15px;
            margin-bottom: 0;
            font-size: 1.5rem;
        }

        .file-list-item .file-details {
            flex: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .file-list-item .file-name {
            text-align: left;
        }

        .file-list-item .file-info {
            margin-top: 0;
            text-align: right;
        }

        /* Vista de detalles */
        .files-details {
            display: table;
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 5px;
        }

        .detail-header {
            display: table-row;
            background: var(--secondary-dark);
            font-weight: bold;
        }

        .detail-header div {
            display: table-cell;
            padding: 10px;
            text-align: left;
        }

        .file-detail-item {
            display: table-row;
            background: var(--glass-bg);
        }

        .file-detail-item:hover {
            background: var(--hover-color);
        }

        .file-detail-item div {
            display: table-cell;
            padding: 10px;
            vertical-align: middle;
            border-bottom: 1px solid var(--glass-border);
        }

        .file-detail-item .file-icon {
            font-size: 1.5rem;
            margin-bottom: 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="particles-container" id="particles"></div>
    
    <div class="top-bar">
        <div class="logo">
            <div>üåå</div>
            <span>NeoExplorer</span>
        </div>
        <div class="search-bar">
            <input type="text" placeholder="Buscar archivos y carpetas...">
        </div>
        <div class="user-actions">
            <button id="refreshBtn">üîÑ</button>
            <button id="settingsBtn">‚öôÔ∏è</button>
            <div class="user-profile">U</div>
        </div>
    </div>
    
    <div class="main-container">
        <div class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">Acciones</div>
                <div class="sidebar-item" id="uploadBtn">
                    <div>üì§</div>
                    <span>Subir Archivos</span>
                </div>
                <div class="sidebar-item" id="openFolderBtn">
                    <div>üìÇ</div>
                    <span>Abrir Carpeta</span>
                </div>
                <div class="sidebar-item" id="demoFilesBtn">
                    <div>üéÆ</div>
                    <span>Modo Demostraci√≥n</span>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Favoritos</div>
                <div class="sidebar-item folder-shortcut" data-path="Documentos">
                    <div>üìÑ</div>
                    <span>Documentos</span>
                </div>
                <div class="sidebar-item folder-shortcut" data-path="Im√°genes">
                    <div>üì∑</div>
                    <span>Im√°genes</span>
                </div>
                <div class="sidebar-item folder-shortcut" data-path="M√∫sica">
                    <div>üéµ</div>
                    <span>M√∫sica</span>
                </div>
                <div class="sidebar-item folder-shortcut" data-path="Videos">
                    <div>üé¨</div>
                    <span>Videos</span>
                </div>
                <div class="sidebar-item folder-shortcut" data-path="Descargas">
                    <div>üì•</div>
                    <span>Descargas</span>
                </div>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-title">Etiquetas</div>
                <div class="sidebar-item tag-filter" data-tag="Importante">
                    <div>üî¥</div>
                    <span>Importante</span>
                </div>
                <div class="sidebar-item tag-filter" data-tag="Personal">
                    <div>üü¢</div>
                    <span>Personal</span>
                </div>
                <div class="sidebar-item tag-filter" data-tag="Trabajo">
                    <div>üîµ</div>
                    <span>Trabajo</span>
                </div>
                <div class="sidebar-item tag-filter" data-tag="Proyecto">
                    <div>üü°</div>
                    <span>Proyecto</span>
                </div>
            </div>
        </div>
        
        <div class="content-area">
            <div class="path-navigation">
                <button class="path-button" id="backBtn">‚¨ÖÔ∏è</button>
                <button class="path-button" id="forwardBtn">‚û°Ô∏è</button>
                <button class="path-button" id="upBtn">‚¨ÜÔ∏è</button>
                <button class="path-button" id="homeBtn">üè†</button>
                <span class="path-seperator">|</span>
                <div id="breadcrumbs">
                    <button class="path-button">Inicio</button>
                </div>
            </div>
            
            <div class="view-options">
                <div class="view-buttons">
                    <button class="view-button active" data-view="grid">üìä Cuadr√≠cula</button>
                    <button class="view-button" data-view="list">üìã Lista</button>
                    <button class="view-button" data-view="details">üîç Detalles</button>
                </div>
                <div class="sort-options">
                    <select id="sortSelect">
                        <option value="name-asc">Ordenar por: Nombre (A-Z)</option>
                        <option value="name-desc">Ordenar por: Nombre (Z-A)</option>
                        <option value="date-desc">Ordenar por: Fecha (Reciente)</option>
                        <option value="date-asc">Ordenar por: Fecha (Antiguo)</option>
                        <option value="size-desc">Ordenar por: Tama√±o (Mayor)</option>
                        <option value="size-asc">Ordenar por: Tama√±o (Menor)</option>
                        <option value="type">Ordenar por: Tipo</option>
                    </select>
                </div>
            </div>
            
            <div id="filesContainer" class="files-grid">
                <!-- Los archivos se generar√°n din√°micamente con JavaScript -->
            </div>
        </div>
    </div>
    
    <div class="status-bar">
        <div id="itemCount">0 elementos</div>
        <div id="storageInfo">Modo Demostraci√≥n</div>
    </div>

    <!-- Input oculto para carga de archivos -->
    <input type="file" id="fileInput" class="file-input" multiple>
    <input type="file" id="folderInput" class="file-input" webkitdirectory directory multiple>

    <!-- Mensaje de compatibilidad -->
    <div class="compatibility-message" id="compatibilityMessage">
        <h3>Funcionalidad limitada</h3>
        <p>Tu navegador no soporta algunas funciones para acceder al sistema de archivos. Se activar√° el modo de demostraci√≥n con archivos de ejemplo.</p>
        <p>Para una experiencia completa, usa Chrome, Edge o un navegador basado en Chromium.</p>
        <button id="dismissCompatibilityMsg">Entendido</button>
    </div>

    <script>
        // Variables globales
        let currentView = 'grid';
        let demoMode = true;
        const fileTypes = [
            { name: 'Documentos', icon: 'üìÑ', extensions: ['docx', 'doc', 'pdf', 'txt', 'rtf', 'odt'] },
            { name: 'Im√°genes', icon: 'üñºÔ∏è', extensions: ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'svg', 'webp'] },
            { name: 'Audio', icon: 'üéµ', extensions: ['mp3', 'wav', 'ogg', 'flac', 'm4a', 'aac'] },
            { name: 'Video', icon: 'üé¨', extensions: ['mp4', 'mov', 'avi', 'mkv', 'webm', 'flv'] },
            { name: 'C√≥digo', icon: 'üíª', extensions: ['js', 'html', 'css', 'py', 'java', 'cpp', 'c', 'php', 'rb'] },
            { name: 'Comprimidos', icon: 'üóúÔ∏è', extensions: ['zip', 'rar', '7z', 'tar', 'gz'] },
            { name: 'Carpeta', icon: 'üìÅ', extensions: [] }
        ];
        let currentFiles = [];
        let filesHistory = [];
        let historyPosition = -1;
        let currentPath = 'Inicio';

        // Referencias a elementos DOM
        const filesContainer = document.getElementById('filesContainer');
        const searchInput = document.querySelector('.search-bar input');
        const viewButtons = document.querySelectorAll('.view-button');
        const sortSelect = document.getElementById('sortSelect');
        const itemCountElement = document.getElementById('itemCount');
        const storageInfoElement = document.getElementById('storageInfo');
        const fileInput = document.getElementById('fileInput');
        const folderInput = document.getElementById('folderInput');
        const compatibilityMessage = document.getElementById('compatibilityMessage');
        const dismissCompatibilityMsg = document.getElementById('dismissCompatibilityMsg');
        const breadcrumbs = document.getElementById('breadcrumbs');
        const backBtn = document.getElementById('backBtn');
        const forwardBtn = document.getElementById('forwardBtn');
        const upBtn = document.getElementById('upBtn');
        const homeBtn = document.getElementById('homeBtn');
        const uploadBtn = document.getElementById('uploadBtn');
        const openFolderBtn = document.getElementById('openFolderBtn');
        const demoFilesBtn = document.getElementById('demoFilesBtn');
        const refreshBtn = document.getElementById('refreshBtn');

        // Funci√≥n para generar part√≠culas de fondo
        function generateParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                // Posici√≥n aleatoria
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                
                particle.style.left = `${x}%`;
                particle.style.top = `${y}%`;
                
                // Tama√±o aleatorio
                const size = Math.random() * 3 + 1;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Opacidad aleatoria
                particle.style.opacity = Math.random() * 0.5 + 0.2;
                
                // Animaci√≥n aleatoria
                const duration = Math.random() * 20 + 10;
                particle.style.animation = `pulse ${duration}s infinite`;
                
                particlesContainer.appendChild(particle);
            }
        }

        // Funci√≥n para obtener el icono de un archivo seg√∫n su extensi√≥n
        function getFileIcon(filename) {
            if (!filename) return '‚ùì';
            
            const extension = filename.split('.').pop().toLowerCase();
            for (const type of fileTypes) {
                if (type.extensions.includes(extension)) {
                    return type.icon;
                }
            }
            return 'üìÑ'; // Icono por defecto para archivos desconocidos
        }

        // Funci√≥n para formatear el tama√±o de un archivo
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Funci√≥n para formatear una fecha
        function formatDate(date) {
            return new Intl.DateTimeFormat('es-ES', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            }).format(date);
        }

        // Funci√≥n para obtener una fecha aleatoria para los archivos de demostraci√≥n
        function getRandomDate() {
            const now = new Date();
            const pastDays = Math.floor(Math.random() * 60);
            const date = new Date(now.getTime() - (pastDays * 24 * 60 * 60 * 1000));
            return date;
        }

                    // Funci√≥n para mostrar notificaciones
        function showNotification(message, isError = false) {
            // Eliminar notificaciones anteriores
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => {
                document.body.removeChild(notification);
            });
            
            // Crear nueva notificaci√≥n
            const notification = document.createElement('div');
            notification.className = `notification ${isError ? 'error' : 'success'}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Mostrar la notificaci√≥n
            setTimeout(() => {
                notification.style.opacity = '1';
            }, 10);
            
            // Ocultar despu√©s de 3 segundos
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Funci√≥n para mostrar elementos de carga
        function showLoading() {
            const overlay = document.createElement('div');
            overlay.className = 'loading-overlay';
            overlay.id = 'loadingOverlay';
            
            const spinner = document.createElement('div');
            spinner.className = 'spinner';
            
            overlay.appendChild(spinner);
            document.body.appendChild(overlay);
        }

        // Funci√≥n para ocultar elementos de carga
        function hideLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                document.body.removeChild(overlay);
            }
        }

        // Funci√≥n para actualizar las migas de pan
        function updateBreadcrumbs(path) {
            breadcrumbs.innerHTML = '';
            
            const segments = path.split('/').filter(Boolean);
            
            // Agregar inicio
            const homeButton = document.createElement('button');
            homeButton.className = 'path-button';
            homeButton.textContent = 'Inicio';
            homeButton.addEventListener('click', () => {
                navigateTo('Inicio');
            });
            breadcrumbs.appendChild(homeButton);
            
            // Agregar segmentos de ruta
            if (segments.length > 0) {
                let currentPath = '';
                
                segments.forEach((segment, index) => {
                    // Separador
                    const sepElement = document.createElement('span');
                    sepElement.className = 'path-seperator';
                    sepElement.textContent = '/';
                    breadcrumbs.appendChild(sepElement);
                    
                    // Actualizar ruta acumulativa
                    currentPath += '/' + segment;
                    
                    // Bot√≥n del segmento
                    const segmentButton = document.createElement('button');
                    segmentButton.className = 'path-button';
                    segmentButton.textContent = segment;
                    
                    // Si no es el √∫ltimo segmento, hacer que sea clickeable
                    if (index < segments.length - 1) {
                        segmentButton.addEventListener('click', () => {
                            navigateTo('Inicio' + currentPath);
                        });
                    }
                    
                    breadcrumbs.appendChild(segmentButton);
                });
            }
        }

        // Funci√≥n para actualizar el contador de elementos
        function updateItemCount() {
            const folderCount = currentFiles.filter(file => file.isDirectory).length;
            const fileCount = currentFiles.filter(file => !file.isDirectory).length;
            
            itemCountElement.textContent = `${currentFiles.length} elementos (${folderCount} carpetas, ${fileCount} archivos)`;
        }

        // Funci√≥n para limpiar el contenedor de archivos
        function clearFilesContainer() {
            filesContainer.innerHTML = '';
        }

        // Funci√≥n para cambiar la vista de archivos
        function changeView(viewType) {
            currentView = viewType;
            
            // Actualizar botones de vista
            viewButtons.forEach(button => {
                if (button.getAttribute('data-view') === viewType) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });
            
            // Actualizar estilo del contenedor
            filesContainer.className = `files-${viewType}`;
            
            // Volver a renderizar los archivos
            renderFiles();
        }

        // Funci√≥n para ordenar archivos
        function sortFiles(files, sortBy) {
            const [criteria, direction] = sortBy.split('-');
            
            // Clonar el array para no modificar el original
            const sorted = [...files];
            
            // Ordenar primero carpetas, luego archivos
            sorted.sort((a, b) => {
                // Si uno es directorio y el otro no, el directorio va primero
                if (a.isDirectory !== b.isDirectory) {
                    return a.isDirectory ? -1 : 1;
                }
                
                // Si ambos son del mismo tipo, ordenar seg√∫n el criterio seleccionado
                switch (criteria) {
                    case 'name':
                        return direction === 'asc' ? 
                            a.name.localeCompare(b.name) : 
                            b.name.localeCompare(a.name);
                    
                    case 'date':
                        return direction === 'asc' ? 
                            new Date(a.modifiedDate) - new Date(b.modifiedDate) : 
                            new Date(b.modifiedDate) - new Date(a.modifiedDate);
                    
                    case 'size':
                        return direction === 'asc' ? 
                            a.size - b.size : 
                            b.size - a.size;
                    
                    case 'type':
                        const extensionA = a.name.split('.').pop() || '';
                        const extensionB = b.name.split('.').pop() || '';
                        return extensionA.localeCompare(extensionB);
                    
                    default:
                        return 0;
                }
            });
            
            return sorted;
        }

        // Funci√≥n para filtrar archivos por b√∫squeda
        function filterFiles(files, searchTerm) {
            if (!searchTerm) return files;
            
            searchTerm = searchTerm.toLowerCase();
            
            return files.filter(file => 
                file.name.toLowerCase().includes(searchTerm) ||
                (file.tags && file.tags.some(tag => tag.toLowerCase().includes(searchTerm)))
            );
        }

        // Funci√≥n para generar archivos de demostraci√≥n
        function generateDemoFiles() {
            const files = [];
            
            // Documentos
            files.push(createDemoFile('Informe trimestral.docx', 'docx', 250000, getRandomDate(), ['Trabajo', 'Importante']));
            files.push(createDemoFile('Presentaci√≥n proyecto.pptx', 'pptx', 1500000, getRandomDate(), ['Trabajo', 'Proyecto']));
            files.push(createDemoFile('Notas reuni√≥n.txt', 'txt', 5000, getRandomDate(), ['Trabajo']));
            files.push(createDemoFile('Presupuesto 2025.xlsx', 'xlsx', 180000, getRandomDate(), ['Trabajo', 'Importante']));
            files.push(createDemoFile('Manual de usuario.pdf', 'pdf', 3500000, getRandomDate(), ['Proyecto']));
            
            // Im√°genes
            files.push(createDemoFile('Foto vacaciones.jpg', 'jpg', 2500000, getRandomDate(), ['Personal']));
            files.push(createDemoFile('Logo empresa.png', 'png', 150000, getRandomDate(), ['Trabajo']));
            files.push(createDemoFile('Dise√±o interfaz.psd', 'psd', 15000000, getRandomDate(), ['Proyecto']));
            
            // Carpetas
            files.push(createDemoDirectory('Documentos', getRandomDate(), 15, ['Trabajo']));
            files.push(createDemoDirectory('Im√°genes', getRandomDate(), 42, ['Personal']));
            files.push(createDemoDirectory('Proyectos', getRandomDate(), 7, ['Proyecto']));
            files.push(createDemoDirectory('Respaldos', getRandomDate(), 3, ['Importante']));
            files.push(createDemoDirectory('Descargas', getRandomDate(), 28, []));
            
            return files;
        }

        // Funci√≥n para crear un archivo de demostraci√≥n
        function createDemoFile(name, extension, size, modifiedDate, tags = []) {
            return {
                name: name,
                isDirectory: false,
                size: size,
                modifiedDate: modifiedDate,
                type: extension,
                tags: tags,
                icon: getFileIcon(name)
            };
        }

        // Funci√≥n para crear un directorio de demostraci√≥n
        function createDemoDirectory(name, modifiedDate, itemCount = 0, tags = []) {
            return {
                name: name,
                isDirectory: true,
                size: 0,
                modifiedDate: modifiedDate,
                itemCount: itemCount,
                tags: tags,
                icon: 'üìÅ'
            };
        }

        // Funci√≥n para renderizar archivos
        function renderFiles() {
            clearFilesContainer();
            
            // Obtener archivos filtrados y ordenados
            const searchTerm = searchInput.value;
            const sortBy = sortSelect.value;
            const filteredFiles = filterFiles(currentFiles, searchTerm);
            const sortedFiles = sortFiles(filteredFiles, sortBy);
            
            // Si no hay archivos, mostrar mensaje
            if (sortedFiles.length === 0) {
                const emptyMessage = document.createElement('div');
                emptyMessage.style.gridColumn = '1 / -1';
                emptyMessage.style.textAlign = 'center';
                emptyMessage.style.padding = '40px';
                emptyMessage.style.color = 'rgba(255, 255, 255, 0.6)';
                
                if (searchTerm) {
                    emptyMessage.innerHTML = 'üîç<br><br>No se encontraron resultados para "' + searchTerm + '"';
                } else {
                    emptyMessage.innerHTML = 'üì≠<br><br>Carpeta vac√≠a';
                }
                
                filesContainer.appendChild(emptyMessage);
                return;
            }
            
            // Renderizar seg√∫n la vista actual
            switch (currentView) {
                case 'grid':
                    renderGridView(sortedFiles);
                    break;
                case 'list':
                    renderListView(sortedFiles);
                    break;
                case 'details':
                    renderDetailsView(sortedFiles);
                    break;
            }
            
            // Animaci√≥n de aparici√≥n
            const fileItems = filesContainer.querySelectorAll('.file-item, .file-list-item, .file-detail-item');
            fileItems.forEach((item, index) => {
                item.style.opacity = '0';
                item.style.transform = 'translateY(10px)';
                
                setTimeout(() => {
                    item.style.opacity = '1';
                    item.style.transform = 'translateY(0)';
                }, index * 30);
            });
        }

        // Renderizar vista de cuadr√≠cula
        function renderGridView(files) {
            files.forEach(file => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.setAttribute('data-name', file.name);
                
                const fileIcon = document.createElement('div');
                fileIcon.className = 'file-icon';
                fileIcon.textContent = file.icon;
                
                const fileName = document.createElement('div');
                fileName.className = 'file-name';
                fileName.textContent = file.name;
                fileName.title = file.name;
                
                const fileInfo = document.createElement('div');
                fileInfo.className = 'file-info';
                
                if (file.isDirectory) {
                    fileInfo.textContent = `${file.itemCount} elementos`;
                } else {
                    fileInfo.textContent = `${formatFileSize(file.size)} ¬∑ ${formatDate(file.modifiedDate)}`;
                }
                
                fileItem.appendChild(fileIcon);
                fileItem.appendChild(fileName);
                fileItem.appendChild(fileInfo);
                
                // A√±adir etiquetas si existen
                if (file.tags && file.tags.length > 0) {
                    const tagIndicator = document.createElement('div');
                    tagIndicator.style.position = 'absolute';
                    tagIndicator.style.top = '5px';
                    tagIndicator.style.right = '5px';
                    tagIndicator.style.display = 'flex';
                    tagIndicator.style.gap = '3px';
                    
                    file.tags.forEach(tag => {
                        const tagDot = document.createElement('span');
                        tagDot.style.width = '8px';
                        tagDot.style.height = '8px';
                        tagDot.style.borderRadius = '50%';
                        tagDot.style.display = 'inline-block';
                        tagDot.title = tag;
                        
                        // Color seg√∫n etiqueta
                        switch(tag) {
                            case 'Importante': tagDot.style.backgroundColor = 'red'; break;
                            case 'Personal': tagDot.style.backgroundColor = 'green'; break;
                            case 'Trabajo': tagDot.style.backgroundColor = 'blue'; break;
                            case 'Proyecto': tagDot.style.backgroundColor = 'gold'; break;
                            default: tagDot.style.backgroundColor = 'gray';
                        }
                        
                        tagIndicator.appendChild(tagDot);
                    });
                    
                    fileItem.appendChild(tagIndicator);
                }
                
                // Eventos
                fileItem.addEventListener('click', (e) => {
                    handleFileClick(file, e);
                });
                
                fileItem.addEventListener('dblclick', () => {
                    handleFileDoubleClick(file);
                });
                
                fileItem.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    showContextMenu(e, file);
                });
                
                filesContainer.appendChild(fileItem);
            });
        }

        // Renderizar vista de lista
        function renderListView(files) {
            files.forEach(file => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-list-item';
                fileItem.setAttribute('data-name', file.name);
                
                const fileIcon = document.createElement('div');
                fileIcon.className = 'file-icon';
                fileIcon.textContent = file.icon;
                
                const fileDetails = document.createElement('div');
                fileDetails.className = 'file-details';
                
                const fileName = document.createElement('div');
                fileName.className = 'file-name';
                fileName.textContent = file.name;
                
                const fileInfo = document.createElement('div');
                fileInfo.className = 'file-info';
                
                if (file.isDirectory) {
                    fileInfo.textContent = `${file.itemCount} elementos ¬∑ ${formatDate(file.modifiedDate)}`;
                } else {
                    fileInfo.textContent = `${formatFileSize(file.size)} ¬∑ ${formatDate(file.modifiedDate)}`;
                }
                
                fileDetails.appendChild(fileName);
                fileDetails.appendChild(fileInfo);
                
                fileItem.appendChild(fileIcon);
                fileItem.appendChild(fileDetails);
                
                // Etiquetas
                if (file.tags && file.tags.length > 0) {
                    const tagContainer = document.createElement('div');
                    tagContainer.style.display = 'flex';
                    tagContainer.style.gap = '5px';
                    tagContainer.style.marginLeft = '15px';
                    
                    file.tags.forEach(tag => {
                        const tagElement = document.createElement('span');
                        tagElement.style.padding = '2px 6px';
                        tagElement.style.borderRadius = '4px';
                        tagElement.style.fontSize = '0.7rem';
                        tagElement.textContent = tag;
                        
                        // Color seg√∫n etiqueta
                        switch(tag) {
                            case 'Importante': 
                                tagElement.style.backgroundColor = 'rgba(255, 0, 0, 0.2)';
                                tagElement.style.color = '#ff6666';
                                break;
                            case 'Personal': 
                                tagElement.style.backgroundColor = 'rgba(0, 255, 0, 0.1)';
                                tagElement.style.color = '#66ff66';
                                break;
                            case 'Trabajo': 
                                tagElement.style.backgroundColor = 'rgba(0, 0, 255, 0.1)';
                                tagElement.style.color = '#6666ff';
                                break;
                            case 'Proyecto': 
                                tagElement.style.backgroundColor = 'rgba(255, 215, 0, 0.1)';
                                tagElement.style.color = '#ffdd66';
                                break;
                            default: 
                                tagElement.style.backgroundColor = 'rgba(128, 128, 128, 0.1)';
                                tagElement.style.color = '#cccccc';
                        }
                        
                        tagContainer.appendChild(tagElement);
                    });
                    
                    fileItem.appendChild(tagContainer);
                }
                
                // Eventos
                fileItem.addEventListener('click', (e) => {
                    handleFileClick(file, e);
                });
                
                fileItem.addEventListener('dblclick', () => {
                    handleFileDoubleClick(file);
                });
                
                fileItem.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    showContextMenu(e, file);
                });
                
                filesContainer.appendChild(fileItem);
            });
        }

        // Renderizar vista de detalles
        function renderDetailsView(files) {
            // Encabezado de la tabla
            const header = document.createElement('div');
            header.className = 'detail-header';
            
            const headerIcon = document.createElement('div');
            headerIcon.textContent = 'Tipo';
            header.appendChild(headerIcon);
            
            const headerName = document.createElement('div');
            headerName.textContent = 'Nombre';
            header.appendChild(headerName);
            
            const headerSize = document.createElement('div');
            headerSize.textContent = 'Tama√±o';
            header.appendChild(headerSize);
            
            const headerDate = document.createElement('div');
            headerDate.textContent = 'Fecha modificaci√≥n';
            header.appendChild(headerDate);
            
            const headerTags = document.createElement('div');
            headerTags.textContent = 'Etiquetas';
            header.appendChild(headerTags);
            
            filesContainer.appendChild(header);
            
            // Filas de archivos
            files.forEach(file => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-detail-item';
                fileItem.setAttribute('data-name', file.name);
                
                const fileIcon = document.createElement('div');
                fileIcon.className = 'file-icon';
                fileIcon.textContent = file.icon;
                
                const fileName = document.createElement('div');
                fileName.textContent = file.name;
                
                const fileSize = document.createElement('div');
                if (file.isDirectory) {
                    fileSize.textContent = `${file.itemCount} elementos`;
                } else {
                    fileSize.textContent = formatFileSize(file.size);
                }
                
                const fileDate = document.createElement('div');
                fileDate.textContent = formatDate(file.modifiedDate);
                
                const fileTags = document.createElement('div');
                fileTags.style.display = 'flex';
                fileTags.style.gap = '5px';
                fileTags.style.flexWrap = 'wrap';
                
                if (file.tags && file.tags.length > 0) {
                    file.tags.forEach(tag => {
                        const tagElement = document.createElement('span');
                        tagElement.style.padding = '2px 6px';
                        tagElement.style.borderRadius = '4px';
                        tagElement.style.fontSize = '0.7rem';
                        tagElement.textContent = tag;
                        
                        // Color seg√∫n etiqueta
                        switch(tag) {
                            case 'Importante': 
                                tagElement.style.backgroundColor = 'rgba(255, 0, 0, 0.2)';
                                tagElement.style.color = '#ff6666';
                                break;
                            case 'Personal': 
                                tagElement.style.backgroundColor = 'rgba(0, 255, 0, 0.1)';
                                tagElement.style.color = '#66ff66';
                                break;
                            case 'Trabajo': 
                                tagElement.style.backgroundColor = 'rgba(0, 0, 255, 0.1)';
                                tagElement.style.color = '#6666ff';
                                break;
                            case 'Proyecto': 
                                tagElement.style.backgroundColor = 'rgba(255, 215, 0, 0.1)';
                                tagElement.style.color = '#ffdd66';
                                break;
                            default: 
                                tagElement.style.backgroundColor = 'rgba(128, 128, 128, 0.1)';
                                tagElement.style.color = '#cccccc';
                        }
                        
                        fileTags.appendChild(tagElement);
                    });
                } else {
                    fileTags.textContent = '-';
                }
                
                fileItem.appendChild(fileIcon);
                fileItem.appendChild(fileName);
                fileItem.appendChild(fileSize);
                fileItem.appendChild(fileDate);
                fileItem.appendChild(fileTags);
                
                // Eventos
                fileItem.addEventListener('click', (e) => {
                    handleFileClick(file, e);
                });
                
                fileItem.addEventListener('dblclick', () => {
                    handleFileDoubleClick(file);
                });
                
                fileItem.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    showContextMenu(e, file);
                });
                
                filesContainer.appendChild(fileItem);
            });
        }

        // Manejar clic en un archivo
        function handleFileClick(file, event) {
            // Eliminar selecci√≥n previa
            const previousSelected = filesContainer.querySelectorAll('.file-item.glow, .file-list-item.glow, .file-detail-item.glow');
            previousSelected.forEach(item => {
                item.classList.remove('glow');
            });
            
            // Aplicar selecci√≥n al elemento actual
            let currentElement;
            if (currentView === 'grid') {
                currentElement = event.currentTarget;
            } else if (currentView === 'list') {
                currentElement = event.currentTarget;
            } else if (currentView === 'details') {
                currentElement = event.currentTarget;
            }
            
            if (currentElement) {
                currentElement.classList.add('glow');
            }
        }

        // Manejar doble clic en un archivo
        function handleFileDoubleClick(file) {
            if (file.isDirectory) {
                // Navegar al directorio
                navigateTo(currentPath + '/' + file.name);
            } else {
                // Para archivos, mostrar vista previa o acci√≥n seg√∫n tipo
                openFile(file);
            }
        }

        // Funci√≥n para abrir un archivo
        function openFile(file) {
            const extension = file.name.split('.').pop().toLowerCase();
            
            // Manejar seg√∫n el tipo de archivo
            if (['jpg', 'jpeg', 'png', 'gif', 'webp', 'bmp'].includes(extension)) {
                showImagePreview(file);
            } else if (['txt', 'md', 'json', 'js', 'html', 'css', 'py', 'java', 'c', 'cpp', 'php'].includes(extension)) {
                showTextPreview(file);
            } else if (extension === 'pdf') {
                showNotification(`Visualizando ${file.name}`);
            } else {
                showNotification(`Archivo seleccionado: ${file.name}`);
            }
        }

        // Mostrar vista previa de im√°genes
        function showImagePreview(file) {
            // En modo demo simplemente mostrar un mensaje
            if (demoMode) {
                showNotification(`Vista previa de imagen: ${file.name}`);
                return;
            }
            
            // Aqu√≠ ir√≠a el c√≥digo para mostrar la vista previa real
        }

        // Mostrar vista previa de texto
        function showTextPreview(file) {
            // En modo demo simplemente mostrar un mensaje
            if (demoMode) {
                showNotification(`Vista previa de texto: ${file.name}`);
                return;
            }
            
            // Aqu√≠ ir√≠a el c√≥digo para mostrar la vista previa real
        }

        // Mostrar men√∫ contextual
        function showContextMenu(event, file) {
            // Eliminar men√∫s contextuales existentes
            document.querySelectorAll('.context-menu').forEach(menu => {
                document.body.removeChild(menu);
            });
            
            // Crear men√∫ contextual
            const contextMenu = document.createElement('div');
            contextMenu.className = 'context-menu';
            contextMenu.style.left = `${event.pageX}px`;
            contextMenu.style.top = `${event.pageY}px`;
            
            // Opciones seg√∫n tipo
            if (file.isDirectory) {
                addContextMenuItem(contextMenu, "Abrir", () => navigateTo(currentPath + '/' + file.name));
                addContextSeparator(contextMenu);
                addContextMenuItem(contextMenu, "Propiedades", () => showProperties(file));
            } else {
                addContextMenuItem(contextMenu, "Abrir", () => openFile(file));
                if (!demoMode) {
                    addContextMenuItem(contextMenu, "Descargar", () => showNotification(`Descargando: ${file.name}`));
                }
                addContextSeparator(contextMenu);
                addContextMenuItem(contextMenu, "Propiedades", () => showProperties(file));
            }
            
            // Agregar men√∫ al documento
            document.body.appendChild(contextMenu);
            
            // Ajustar posici√≥n si est√° fuera de la pantalla
            const menuRect = contextMenu.getBoundingClientRect();
            if (menuRect.right > window.innerWidth) {
                contextMenu.style.left = `${window.innerWidth - menuRect.width - 10}px`;
            }
            if (menuRect.bottom > window.innerHeight) {
                contextMenu.style.top = `${window.innerHeight - menuRect.height - 10}px`;
            }
            
            // Cerrar el men√∫ al hacer clic en cualquier lugar
            document.addEventListener('click', function closeMenu(e) {
                if (!contextMenu.contains(e.target)) {
                    if (document.body.contains(contextMenu)) {
                        document.body.removeChild(contextMenu);
                    }
                    document.removeEventListener('click', closeMenu);
                }
            });
            
            // Cerrar el men√∫ al presionar Escape
            document.addEventListener('keydown', function closeMenuEsc(e) {
                if (e.key === 'Escape') {
                    if (document.body.contains(contextMenu)) {
                        document.body.removeChild(contextMenu);
                    }
                    document.removeEventListener('keydown', closeMenuEsc);
                }
            });
        }

        // Agregar √≠tem al men√∫ contextual
        function addContextMenuItem(menu, text, action) {
            const item = document.createElement('div');
            item.className = 'context-item';
            item.textContent = text;
            item.addEventListener('click', action);
            menu.appendChild(item);
        }

        // Agregar separador al men√∫ contextual
        function addContextSeparator(menu) {
            const separator = document.createElement('div');
            separator.className = 'context-separator';
            menu.appendChild(separator);
        }

        // Mostrar propiedades de un archivo o carpeta
        function showProperties(file) {
            // Crear modal
            const modal = document.createElement('div');
            modal.className = 'modal';
            
            // Crear contenedor
            const content = document.createElement('div');
            content.className = 'preview-content';
            content.style.maxWidth = '500px';
            
            // Encabezado
            const header = document.createElement('div');
            header.className = 'preview-header';
            
            const title = document.createElement('div');
            title.textContent = file.isDirectory ? 
                "Propiedades de la carpeta" : "Propiedades del archivo";
            
            const closeButton = document.createElement('button');
            closeButton.className = 'preview-close';
            closeButton.textContent = '√ó';
            closeButton.onclick = () => document.body.removeChild(modal);
            
            header.appendChild(title);
            header.appendChild(closeButton);
            
            // Cuerpo
            const body = document.createElement('div');
            body.className = 'preview-body';
            
            // Contenido
            const propList = document.createElement('div');
            propList.style.display = 'grid';
            propList.style.gridTemplateColumns = 'auto 1fr';
            propList.style.gap = '10px';
            propList.style.alignItems = 'start';
            
            // Agregar propiedades
            addProperty(propList, "Nombre:", file.name);
            addProperty(propList, "Tipo:", file.isDirectory ? 
                "Carpeta" : getFileType(file.name));
            
            if (!file.isDirectory) {
                addProperty(propList, "Tama√±o:", formatFileSize(file.size));
            } else {
                addProperty(propList, "Contenido:", `${file.itemCount} elementos`);
            }
            
            addProperty(propList, "Modificado:", formatDate(file.modifiedDate));
            
            if (!file.isDirectory) {
                const extension = file.name.split('.').pop().toLowerCase();
                if (extension) {
                    addProperty(propList, "Extensi√≥n:", extension.toUpperCase());
                }
            }
            
            addProperty(propList, "Ruta:", currentPath + '/' + file.name);
            
            if (file.tags && file.tags.length > 0) {
                addProperty(propList, "Etiquetas:", file.tags.join(', '));
            }
            
            body.appendChild(propList);
            
            // Agregar elementos
            content.appendChild(header);
            content.appendChild(body);
            modal.appendChild(content);
            document.body.appendChild(modal);
            
            // Cerrar con Escape
            document.addEventListener('keydown', function closeOnEsc(e) {
                if (e.key === 'Escape') {
                    document.body.removeChild(modal);
                    document.removeEventListener('keydown', closeOnEsc);
                }
            });
        }

        // Agregar una propiedad a la lista
        function addProperty(container, label, value) {
            const labelElement = document.createElement('div');
            labelElement.textContent = label;
            labelElement.style.fontWeight = 'bold';
            labelElement.style.textAlign = 'right';
            
            const valueElement = document.createElement('div');
            valueElement.textContent = value;
            valueElement.style.wordBreak = 'break-word';
            
            container.appendChild(labelElement);
            container.appendChild(valueElement);
        }

        // Obtener tipo de archivo descriptivo
        function getFileType(filename) {
            const extension = filename.split('.').pop().toLowerCase();
            
            const typeMap = {
                // Documentos
                'pdf': 'Documento PDF',
                'doc': 'Documento de Word',
                'docx': 'Documento de Word',
                'txt': 'Documento de texto',
                'rtf': 'Documento de texto enriquecido',
                'odt': 'Documento OpenDocument',
                'xlsx': 'Hoja de c√°lculo Excel',
                'pptx': 'Presentaci√≥n PowerPoint',
                
                // Im√°genes
                'jpg': 'Imagen JPEG',
                'jpeg': 'Imagen JPEG',
                'png': 'Imagen PNG',
                'gif': 'Imagen GIF',
                'bmp': 'Imagen de mapa de bits',
                'svg': 'Gr√°fico vectorial SVG',
                'webp': 'Imagen WebP',
                'psd': 'Archivo Adobe Photoshop',
                
                // Audio
                'mp3': 'Audio MP3',
                'wav': 'Audio WAV',
                'ogg': 'Audio OGG',
                'flac': 'Audio FLAC',
                'm4a': 'Audio M4A',
                'aac': 'Audio AAC',
                
                // Video
                'mp4': 'Video MP4',
                'mov': 'Video QuickTime',
                'avi': 'Video AVI',
                'mkv': 'Video Matroska',
                'webm': 'Video WebM',
                
                // C√≥digo
                'js': 'Archivo JavaScript',
                'html': 'Documento HTML',
                'css': 'Hoja de estilo CSS',
                'py': 'Script Python',
                'java': 'C√≥digo fuente Java',
                'cpp': 'C√≥digo fuente C++',
                'c': 'C√≥digo fuente C',
                'php': 'Script PHP',
                
                // Comprimidos
                'zip': 'Archivo comprimido ZIP',
                'rar': 'Archivo comprimido RAR',
                '7z': 'Archivo comprimido 7-Zip',
                'tar': 'Archivo TAR',
                'gz': 'Archivo comprimido GZIP'
            };
            
            return typeMap[extension] || `Archivo ${extension.toUpperCase()}`;
        }

        // Navegar a una ruta
        function navigateTo(path) {
            // Actualizar ruta actual
            currentPath = path;
            
            // Actualizar migas de pan
            updateBreadcrumbs(path);
            
            // Actualizar historial
            if (historyPosition === -1 || filesHistory[historyPosition].path !== path) {
                // Si estamos en medio del historial, eliminar las entradas posteriores
                if (historyPosition !== -1 && historyPosition < filesHistory.length - 1) {
                    filesHistory = filesHistory.slice(0, historyPosition + 1);
                }
                
                // Generar contenido para la nueva ruta
                const pathFiles = generateFilesForPath(path);
                
                // Guardar en historial
                filesHistory.push({ path: path, files: pathFiles });
                historyPosition = filesHistory.length - 1;
            }
            
            // Establecer archivos actuales
            currentFiles = [...filesHistory[historyPosition].files];
            
            // Actualizar contador de elementos
            updateItemCount();
            
            // Renderizar archivos
            renderFiles();
        }

        // Generar archivos para una ruta espec√≠fica
        function generateFilesForPath(path) {
            // Si es la ruta ra√≠z, mostrar archivos de demostraci√≥n
            if (path === 'Inicio') {
                return generateDemoFiles();
            }
            
            // Verificar si la ruta es una carpeta favorita
            const pathSegments = path.split('/').filter(Boolean);
            if (pathSegments.length === 1) {
                // Si es una carpeta de favoritos (nivel 1)
                const folderName = pathSegments[0];
                return generateDemoFolderContent(folderName);
            }
            
            // Para otros casos, generar contenido aleatorio
            return generateRandomFolderContent();
        }

        // Generar contenido para carpetas espec√≠ficas
        function generateDemoFolderContent(folderName) {
            const files = [];
            
            // Contenido seg√∫n la carpeta
            switch(folderName) {
                case 'Documentos':
                    files.push(createDemoFile('Informe ventas.docx', 'docx', 450000, getRandomDate(), ['Trabajo']));
                    files.push(createDemoFile('Contrato.pdf', 'pdf', 1200000, getRandomDate(), ['Importante']));
                    files.push(createDemoFile('Recetas.txt', 'txt', 15000, getRandomDate(), ['Personal']));
                    files.push(createDemoFile('Notas de curso.pdf', 'pdf', 800000, getRandomDate(), []));
                    files.push(createDemoDirectory('Personal', getRandomDate(), 8, ['Personal']));
                    files.push(createDemoDirectory('Trabajo', getRandomDate(), 15, ['Trabajo']));
                    break;
                    
                case 'Im√°genes':
                    files.push(createDemoFile('Vacaciones 2024.jpg', 'jpg', 3500000, getRandomDate(), ['Personal']));
                    files.push(createDemoFile('Cumplea√±os.png', 'png', 2800000, getRandomDate(), ['Personal']));
                    files.push(createDemoFile('Dise√±o web.psd', 'psd', 15000000, getRandomDate(), ['Proyecto']));
                    files.push(createDemoFile('Logo.svg', 'svg', 45000, getRandomDate(), ['Trabajo']));
                    files.push(createDemoDirectory('Familia', getRandomDate(), 24, ['Personal']));
                    files.push(createDemoDirectory('Capturas', getRandomDate(), 12, []));
                    break;
                    
                case 'M√∫sica':
                    files.push(createDemoFile('Playlist rock.mp3', 'mp3', 8500000, getRandomDate(), ['Personal']));
                    files.push(createDemoFile('Piano cl√°sico.flac', 'flac', 25000000, getRandomDate(), ['Personal']));
                    files.push(createDemoFile('Sonidos ambiente.wav', 'wav', 15000000, getRandomDate(), []));
                    files.push(createDemoFile('Podcast.mp3', 'mp3', 35000000, getRandomDate(), []));
                    files.push(createDemoDirectory('Rock', getRandomDate(), 45, ['Personal']));
                    files.push(createDemoDirectory('Jazz', getRandomDate(), 32, ['Personal']));
                    break;
                    
                case 'Videos':
                    files.push(createDemoFile('Presentaci√≥n proyecto.mp4', 'mp4', 125000000, getRandomDate(), ['Trabajo', 'Proyecto']));
                    files.push(createDemoFile('Vacaciones.mov', 'mov', 350000000, getRandomDate(), ['Personal']));
                    files.push(createDemoFile('Tutorial.webm', 'webm', 85000000, getRandomDate(), []));
                    files.push(createDemoFile('Conferencia.mkv', 'mkv', 500000000, getRandomDate(), ['Trabajo']));
                    files.push(createDemoDirectory('Tutoriales', getRandomDate(), 8, ['Proyecto']));
                    files.push(createDemoDirectory('Familia', getRandomDate(), 12, ['Personal']));
                    break;
                    
                case 'Descargas':
                    files.push(createDemoFile('Setup.exe', 'exe', 56000000, getRandomDate(), []));
                    files.push(createDemoFile('Manual.pdf', 'pdf', 3200000, getRandomDate(), []));
                    files.push(createDemoFile('Datos.zip', 'zip', 78000000, getRandomDate(), ['Importante']));
                    files.push(createDemoFile('Actualizaci√≥n.msi', 'msi', 125000000, getRandomDate(), []));
                    files.push(createDemoDirectory('Software', getRandomDate(), 5, []));
                    files.push(createDemoDirectory('Temporal', getRandomDate(), 17, []));
                    break;
                    
                default:
                    // Carpeta gen√©rica
                    files.push(createDemoFile('Documento.pdf', 'pdf', 1200000, getRandomDate(), []));
                    files.push(createDemoFile('Imagen.jpg', 'jpg', 2500000, getRandomDate(), []));
                    files.push(createDemoFile('Archivo.zip', 'zip', 15000000, getRandomDate(), []));
                    files.push(createDemoDirectory('Subcarpeta 1', getRandomDate(), 5, []));
                    files.push(createDemoDirectory('Subcarpeta 2', getRandomDate(), 8, []));
            }
            
            return files;
        }

        // Generar contenido aleatorio para carpetas
        function generateRandomFolderContent() {
            const files = [];
            const fileCount = Math.floor(Math.random() * 8) + 2; // 2-10 archivos
            const folderCount = Math.floor(Math.random() * 3) + 1; // 1-3 carpetas
            
            // Generar carpetas
            for (let i = 0; i < folderCount; i++) {
                files.push(createDemoDirectory(`Carpeta ${i+1}`, getRandomDate(), Math.floor(Math.random() * 20) + 1, []));
            }
            
            // Generar archivos
            const fileTypes = ['docx', 'pdf', 'jpg', 'png', 'mp3', 'mp4', 'zip', 'txt'];
            const fileNames = ['Documento', 'Archivo', 'Datos', 'Reporte', 'Imagen', 'Media', 'Informaci√≥n', 'Notas'];
            
            for (let i = 0; i < fileCount; i++) {
                const fileType = fileTypes[Math.floor(Math.random() * fileTypes.length)];
                const fileName = fileNames[Math.floor(Math.random() * fileNames.length)];
                const fileSize = Math.floor(Math.random() * 10000000) + 5000; // 5KB - 10MB
                
                files.push(createDemoFile(`${fileName} ${i+1}.${fileType}`, fileType, fileSize, getRandomDate(), []));
            }
            
            return files;
        }

        // Configurar eventos de la interfaz
        function setupEvents() {
            // Botones de navegaci√≥n
            backBtn.addEventListener('click', () => {
                if (historyPosition > 0) {
                    historyPosition--;
                    currentPath = filesHistory[historyPosition].path;
                    currentFiles = [...filesHistory[historyPosition].files];
                    updateBreadcrumbs(currentPath);
                    updateItemCount();
                    renderFiles();
                }
            });
            
            forwardBtn.addEventListener('click', () => {
                if (historyPosition < filesHistory.length - 1) {
                    historyPosition++;
                    currentPath = filesHistory[historyPosition].path;
                    currentFiles = [...filesHistory[historyPosition].files];
                    updateBreadcrumbs(currentPath);
                    updateItemCount();
                    renderFiles();
                }
            });
            
            upBtn.addEventListener('click', () => {
                if (currentPath !== 'Inicio') {
                    const pathSegments = currentPath.split('/').filter(Boolean);
                    if (pathSegments.length > 1) {
                        // Subir un nivel
                        const newPath = 'Inicio/' + pathSegments.slice(0, -1).join('/');
                        navigateTo(newPath);
                    } else {
                        // Volver a la ra√≠z
                        navigateTo('Inicio');
                    }
                }
            });
            
            homeBtn.addEventListener('click', () => {
                navigateTo('Inicio');
            });
            
            // Botones de acci√≥n
            uploadBtn.addEventListener('click', () => {
                if (demoMode) {
                    showNotification('En modo demostraci√≥n no se pueden subir archivos reales', true);
                } else {
                    fileInput.click();
                }
            });
            
            openFolderBtn.addEventListener('click', () => {
                if (window.showDirectoryPicker) {
                    // Usar API real
                    toggleDemoMode(false);
                    showNotification('Esta funci√≥n requiere navegadores que soporten la API File System Access');
                } else {
                    // Mostrar mensaje de compatibilidad
                    compatibilityMessage.style.display = 'block';
                }
            });
            
            demoFilesBtn.addEventListener('click', () => {
                toggleDemoMode(true);
                navigateTo('Inicio');
                showNotification('Modo demostraci√≥n activado');
            });
            
            refreshBtn.addEventListener('click', () => {
                // Recargar la carpeta actual
                showLoading();
                setTimeout(() => {
                    // Simular recarga
                    currentFiles = generateFilesForPath(currentPath);
                    renderFiles();
                    updateItemCount();
                    hideLoading();
                    showNotification('Carpeta actualizada');
                }, 500);
            });
            
            // Botones de vista
            viewButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const viewType = button.getAttribute('data-view');
                    changeView(viewType);
                });
            });
            
            // B√∫squeda
            searchInput.addEventListener('input', () => {
                renderFiles();
            });
            
            // Ordenamiento
            sortSelect.addEventListener('change', () => {
                renderFiles();
            });
            
            // Carpetas favoritas
            document.querySelectorAll('.folder-shortcut').forEach(shortcut => {
                shortcut.addEventListener('click', () => {
                    const path = 'Inicio/' + shortcut.getAttribute('data-path');
                    navigateTo(path);
                });
            });
            
            // Filtros de etiquetas
            document.querySelectorAll('.tag-filter').forEach(filter => {
                filter.addEventListener('click', () => {
                    const tag = filter.getAttribute('data-tag');
                    searchInput.value = tag;
                    renderFiles();
                });
            });
            
            // Mensaje de compatibilidad
            dismissCompatibilityMsg.addEventListener('click', () => {
                compatibilityMessage.style.display = 'none';
            });
        }

        // Cambiar entre modo real y demostraci√≥n
        function toggleDemoMode(enable) {
            demoMode = enable;
            storageInfoElement.textContent = enable ? 'Modo Demostraci√≥n' : 'Acceso al Sistema de Archivos';
        }

        // Verificar compatibilidad del navegador
        function checkBrowserCompatibility() {
            const hasFileSystemAccess = 'showDirectoryPicker' in window;
            
            if (!hasFileSystemAccess) {
                compatibilityMessage.style.display = 'block';
                toggleDemoMode(true);
            }
            
            return hasFileSystemAccess;
        }

        // Inicializar la aplicaci√≥n
        function init() {
            // Generar part√≠culas
            generateParticles();
            
            // Configurar eventos
            setupEvents();
            
            // Verificar compatibilidad
            const hasFileSystemAccess = checkBrowserCompatibility();
            
            // Navegar a la ruta inicial
            navigateTo('Inicio');
            
            // Mostrar mensaje de bienvenida
            showNotification(hasFileSystemAccess ? 
                'Bienvenido a NeoExplorer. Explora tus archivos con estilo futurista.' : 
                'Bienvenido a NeoExplorer (Modo Demostraci√≥n)'
            );
        }

        // Iniciar cuando el DOM est√© listo
        document.addEventListener('DOMContentLoaded', init);
    </script> 