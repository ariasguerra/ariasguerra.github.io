<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entrenamiento Interactivo: Seguridad Operacional (Inst. 013)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos generales y espec√≠ficos para un look m√°s profesional */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa; /* Un gris muy claro diferente */
        }
        #app-container {
            background-color: #ffffff;
            border-radius: 0.75rem;
            box-shadow: 0 8px 20px -4px rgba(0, 0, 0, 0.06), 0 6px 10px -4px rgba(0, 0, 0, 0.05); /* Sombra ajustada */
        }
        h1, h2, h3, h4 {
             color: #212529; /* Un negro m√°s suave */
        }
        h2.text-blue-700 {
            color: #0056b3; /* Un azul diferente */
        }
        .module-content { display: none; position: relative; }
        .step-content, .scenario-content { display: none; }
        .step-content.active, .scenario-content.active { display: block; }

        .feedback { display: none; margin-top: 1rem; padding: 0.875rem 1rem; border-radius: 0.5rem; font-size: 0.9rem; border-width: 1px; }
        .feedback.correct { background-color: #e6f4ea; border-color: #28a745; color: #155724; } /* Verdes m√°s suaves */
        .feedback.incorrect { background-color: #f8d7da; border-color: #dc3545; color: #721c24; } /* Rojos m√°s suaves */

        .option-button {
            display: block; width: 100%; text-align: left; margin-top: 0.75rem; padding: 0.875rem 1.25rem;
            border: 1px solid #ced4da; /* Gris m√°s claro */ border-radius: 0.5rem; background-color: #ffffff;
            color: #495057; /* Gris oscuro */ font-weight: 500;
            transition: background-color 0.2s, border-color 0.2s, box-shadow 0.2s; cursor: pointer;
        }
        .option-button:hover:not(:disabled) {
            background-color: #f8f9fa; border-color: #adb5bd;
        }
         .option-button:disabled { cursor: not-allowed; opacity: 0.75; }
        .option-button.selected {
             border-color: #007bff; background-color: #e7f3ff; /* Azul claro */
             font-weight: 600; color: #004085; /* Azul oscuro */
             box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
        }
         .option-button.correct-answer {
             border-color: #28a745; background-color: #d4edda; color: #155724;
         }
         .option-button.incorrect-answer {
             border-color: #dc3545; background-color: #f8d7da; color: #721c24;
         }

         /* Estilo para las fichas del men√∫ principal */
         .menu-card {
             display: flex; flex-direction: column; align-items: center;
             padding: 1.5rem; margin-bottom: 1rem; border: 1px solid #dee2e6;
             border-radius: 0.75rem; background-color: #ffffff;
             text-align: center; cursor: pointer;
             transition: background-color 0.2s, box-shadow 0.3s, transform 0.2s; height: 100%;
             box-shadow: 0 2px 4px rgba(0,0,0,0.05);
         }
         .menu-card:hover {
             background-color: #f8f9fa;
             box-shadow: 0 5px 15px rgba(0,0,0,0.08);
             transform: translateY(-3px);
         }
         .menu-card-icon {
             font-size: 2.5rem; margin-bottom: 1rem; color: #0056b3; /* Azul principal */
             background-color: #e7f3ff; /* Azul muy claro */ padding: 0.75rem; border-radius: 50%;
             width: 60px; height: 60px; display: inline-flex; align-items: center; justify-content: center;
         }
         .menu-card-icon svg { width: 100%; height: 100%; }
         .menu-card-title {
             font-weight: 600; color: #343a40; /* Gris m√°s oscuro */ font-size: 1rem; margin-bottom: 0.25rem;
         }
         .menu-card-subtitle { font-size: 0.875rem; color: #6c757d; /* Gris medio */ }

         /* Ajuste para listas dentro de pasos */
         .step-content ul { padding-left: 1.5rem; margin-top: 0.5rem; }
         .step-content ul li { margin-bottom: 0.4rem; line-height: 1.5; }

         /* Botones de navegaci√≥n */
         .nav-button {
             font-weight: 600; padding: 0.6rem 1.5rem; border-radius: 0.5rem; transition: background-color 0.2s, transform 0.1s;
             box-shadow: 0 1px 2px rgba(0,0,0,0.05);
         }
         .nav-button:hover { transform: scale(1.03); box-shadow: 0 2px 4px rgba(0,0,0,0.07); }
         .nav-button.primary { background-color: #007bff; color: white; } /* Azul Bootstrap */
         .nav-button.primary:hover { background-color: #0056b3; }
         .nav-button.secondary { background-color: #6c757d; color: white; } /* Gris Bootstrap */
         .nav-button.secondary:hover { background-color: #5a6268; }
         .nav-button.success { background-color: #28a745; color: white; } /* Verde Bootstrap */
         .nav-button.success:hover { background-color: #218838; }

         /* Bot√≥n Volver al Men√∫ */
        .back-to-menu-btn {
            position: absolute; top: 1.5rem; right: 1.5rem;
            background-color: #e9ecef; color: #495057;
            font-size: 0.8rem; font-weight: 500; padding: 0.3rem 0.8rem; border-radius: 9999px;
            transition: background-color 0.2s, color 0.2s; z-index: 10; border: 1px solid #dee2e6;
        }
        .back-to-menu-btn:hover { background-color: #dee2e6; color: #343a40; }

    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 p-4 md:p-8">

    <div id="app-container" class="max-w-5xl mx-auto bg-white rounded-lg shadow-xl p-6 md:p-10">

        <div id="main-menu" class="text-center">
            <h1 class="text-2xl md:text-3xl font-bold mb-4">Centro de Entrenamiento Interactivo</h1>
            <h2 class="text-xl md:text-2xl font-semibold text-blue-700 mb-8">Seguridad Operacional (Inst. 013/2022)</h2>
            <p class="text-gray-600 mb-8">Selecciona el tema que deseas practicar:</p>
            <div id="menu-cards-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                </div>
        </div>

        <div id="active-module" class="module-content">
             <button onclick="goToMainMenu()" class="back-to-menu-btn">
                &larr; Volver al Men√∫
            </button>
            <h1 id="module-title" class="text-2xl md:text-3xl font-bold mb-1 pt-8 md:pt-0"></h1>
            <h2 id="module-subtitle" class="text-lg md:text-xl font-semibold text-blue-700 mb-6"></h2>

            <div id="protocolo" style="display: none;">
                <h3 class="text-xl font-semibold mb-4 border-b pb-2">Instrucciones Clave</h3>
                <div id="protocol-steps-container"></div>
                <div id="verification-question" style="display: none;" class="mt-6 p-5 border rounded-lg bg-blue-50">
                     <h4 class="font-bold text-lg mb-3 text-blue-800">¬°Verifica tu Comprensi√≥n!</h4>
                     <p id="verification-question-text" class="mb-4 text-gray-700 font-medium"></p>
                     <div id="verification-options-container"></div>
                     <div id="verification-feedback" class="feedback"></div>
                     <div class="mt-6 text-center">
                        <button id="start-scenarios-btn" onclick="startScenarios()" style="display:none;" class="nav-button success">
                            Iniciar Escenarios Simulados
                        </button>
                     </div>
                </div>
            </div>

            <div id="escenarios" style="display: none;">
                <h3 class="text-xl font-semibold mb-4 border-b pb-2">Escenarios Simulados</h3>
                <div id="scenarios-container"></div>
            </div>

            <div id="resumen" style="display: none;" class="p-6 border rounded-lg bg-blue-50 text-center">
                <h3 class="text-xl font-semibold text-blue-700 mb-4">Resumen del M√≥dulo</h3>
                 <div id="summary-icon" class="flex justify-center space-x-4 my-5 text-4xl text-green-600">
                    <span>&#127941;</span>
                 </div>
                <p class="text-gray-800 mb-4 font-semibold text-lg">¬°Felicidades por completar el m√≥dulo!</p>
                <p class="font-medium mb-3 text-gray-700">Puntos Clave Recordados:</p>
                <ul id="summary-points" class="list-disc list-inside text-gray-600 space-y-1 mb-8 text-left inline-block"></ul>
                 <div class="flex justify-center space-x-4">
                    <button onclick="restartCurrentModule()" class="nav-button secondary">
                        Reiniciar M√≥dulo
                    </button>
                     <button onclick="goToMainMenu()" class="nav-button primary">
                        Men√∫ Principal
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Iconos SVG ---
        const svgIcons = {
            planificacion: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 6.75V15m6-6v8.25m.503-6.998 4.875-2.178a.75.75 0 0 0-.918-1.184l-5.5 2.444a.75.75 0 0 0-.404.643v10.602a.75.75 0 0 0 .918 1.184l5.5-2.444a.75.75 0 0 0 .404-.642V10.5a.75.75 0 0 0-.918-1.184l-4.875 2.178Z" /></svg>`, // Mapa
            desplazamiento: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0c-.563.058-.987.538-.987 1.106v.958m12.026 0h-2.25m0-3.182.08-.056a48.554 48.554 0 0 1 10.026 0 .08.056m-12.026 0h-2.25" /></svg>`, // Veh√≠culo
            autoproteccion: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z" /></svg>`, // Escudo
            comunicaciones: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.056 3 11.625 7.03 20.25 12 20.25Zm0 0V12m0 8.25V12M12 12v-3.75M12 12V3.75m0 8.25v-3.75M3 11.625v-3.75m18 3.75v-3.75m-15 3.75H3m18 0h-3.75M3 11.625c0-4.556 4.03-8.25 9-8.25v3.75c-2.89 0-5.384 1.667-6.68 4.125H3Zm18 0c0-4.556-4.03-8.25-9-8.25v3.75c2.89 0 5.384 1.667 6.68 4.125h3.75Z" /></svg>`, // Comunicaciones/Antena
        };

        // --- Definici√≥n de Datos de los M√≥dulos (Basado en Instructivo 013) ---
        const modulesData = [
            {
                id: 'planificacion',
                title: 'Planificaci√≥n Desplazamientos',
                menuIcon: svgIcons.planificacion,
                subtitle: 'Valoraci√≥n Previa y Documentaci√≥n',
                protocolSteps: [
                    { title: 'Paso 1: Contextualizaci√≥n y Valoraci√≥n', icon: 'üó∫Ô∏è', color: 'text-blue-600', points: ['Articular modalidades/especialidades para an√°lisis integral.', 'Contexto: Geograf√≠a, topograf√≠a, v√≠as, actores criminales, delitos, antecedentes acciones armadas, alertas inteligencia.', 'Valorar objetivamente necesidad de desplazamiento terrestre (admin./operativo).'] },
                    { title: 'Paso 2: Documentaci√≥n y Seguridad Informaci√≥n', icon: 'üìÑ', color: 'text-green-600', points: ['Expedir acto administrativo que motiva desplazamiento (orden servicio/marcha/operaciones, etc.).', 'Garantizar que contenido cumpla pol√≠ticas seguridad informaci√≥n (minimizar riesgos filtraci√≥n).'] },
                    { title: 'Paso 3: Difusi√≥n Alertas y Evaluaci√≥n', icon: 'üö®', color: 'text-red-600', points: ['Generar difusi√≥n alertas inteligencia al personal.', 'Implementar mecanismos seguimiento para evaluar acciones tomadas.', 'Anticipar materializaci√≥n riesgos.'] },
                    { title: 'Paso 4: Valoraci√≥n del Mando', icon: 'üßë‚Äç‚úàÔ∏è', color: 'text-purple-600', points: ['Comandantes deben valorar previamente necesidad de ordenar/autorizar desplazamientos en zonas de alteraci√≥n orden p√∫blico.', 'Disponer medidas seguridad descritas en el instructivo.'] }
                ],
                 verificationQuestion: {
                    text: 'Antes de un desplazamiento, ¬øqu√© aspecto fundamental se debe valorar seg√∫n el Instructivo 013?',
                    options: [ { text: 'La disponibilidad de veh√≠culos √∫nicamente.', correct: false }, { text: 'La necesidad objetiva del desplazamiento, considerando contexto, riesgos y alertas.', correct: true }, { text: 'La hora de salida preferida por el personal.', correct: false } ],
                    feedbackCorrect: '¬°Correcto! El instructivo enfatiza valorar objetivamente la necesidad del desplazamiento basada en un an√°lisis integral del contexto y los riesgos.',
                    feedbackIncorrect: 'Incorrecto. Si bien los veh√≠culos son importantes, la valoraci√≥n de la necesidad y el riesgo es el primer paso clave seg√∫n el instructivo.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Desplazamiento Administrativo', icon: 'üöó', color: 'text-yellow-600', text: 'Se requiere enviar un documento administrativo urgente a una estaci√≥n ubicada en zona rural con antecedentes de hostigamientos. ¬øCu√°l ser√≠a la primera acci√≥n a considerar seg√∫n el instructivo?', options: [ { id: 'a', text: '(a) Enviar al funcionario inmediatamente en una motocicleta para agilizar.' }, { id: 'b', text: '(b) Valorar objetivamente la necesidad del desplazamiento f√≠sico vs. alternativas (ej. correo electr√≥nico seguro, SIART si aplica), considerando alertas y riesgos.' }, { id: 'c', text: '(c) Expedir la orden de marcha sin an√°lisis adicional por ser tr√°mite administrativo.' }, { id: 'd', text: '(d) Preguntar al funcionario si se siente seguro para ir.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. La urgencia no debe primar sobre la valoraci√≥n de seguridad.", 'b': "¬°Correcto! El instructivo pide valorar objetivamente la necesidad del desplazamiento terrestre, considerando el contexto, riesgos y alertas, antes de ordenarlo.", 'c': "Incorrecto. La documentaci√≥n es necesaria, pero posterior a la valoraci√≥n.", 'd': "Incorrecto. La percepci√≥n del funcionario es importante, pero la valoraci√≥n objetiva del riesgo por parte del mando es el primer paso." } },
                ],
                 summaryPoints: [ '<strong>Articular capacidades</strong> para an√°lisis integral del contexto.', 'Valorar <strong>objetivamente la necesidad</strong> del desplazamiento.', 'Expedir <strong>acto administrativo</strong> y cuidar <strong>seguridad de la informaci√≥n</strong>.', 'Difundir <strong>alertas de inteligencia</strong> y evaluar acciones.', 'El <strong>mando valora</strong> necesidad en zonas de riesgo.' ]
            },
            {
                id: 'durante_desplazamiento',
                title: 'Seguridad Durante Desplazamiento',
                menuIcon: svgIcons.desplazamiento,
                subtitle: 'Veh√≠culos, Rutas y T√°cticas',
                protocolSteps: [
                    { title: 'Paso 1: Veh√≠culos y Medios', icon: 'üöô', color: 'text-blue-600', points: ['Evaluar viabilidad veh√≠culo uniformado/no uniformado seg√∫n riesgo.', 'Verificar estado mec√°nico √≥ptimo.', 'Usar SIART (drones) si hay disponibilidad para revistas a√©reas (especialmente rural/riesgo).'] },
                    { title: 'Paso 2: Rutas y Horarios', icon: 'üîÑ', color: 'text-green-600', points: ['Alternar rutas y horarios (evitar rutina).', 'Basarse en apreciaciones, alertas, an√°lisis geogr√°fico (evaluar tramos criticidad).'] },
                    { title: 'Paso 3: Disciplina T√°ctica', icon: 'üëÄ', color: 'text-orange-600', points: ['Personal concentrado en seguridad y observaci√≥n del entorno.', 'Asignar roles de seguridad durante desplazamiento.', 'Aplicar t√©cnicas patrullaje rural a pie si aplica (Gu√≠a 2CD-GU-0002).'] },
                    { title: 'Paso 4: Apoyo y Coordinaci√≥n', icon: 'ü§ù', color: 'text-purple-600', points: ['Coordinar acompa√±amiento seguridad grupos operativos si es necesario.', 'Desplegar anillos seguridad con FF.MM. si nivel riesgo lo amerita.', 'Contacto constante con unidades emergencia (hospitales, bomberos, etc.).'] }
                ],
                 verificationQuestion: {
                    text: '¬øPor qu√© es importante alternar rutas y horarios de desplazamiento seg√∫n el Instructivo 013?',
                    options: [ { text: 'Para conocer mejor la jurisdicci√≥n.', correct: false }, { text: 'Para evitar la rutina y dificultar la observaci√≥n criminal o emboscadas.', correct: true }, { text: 'Para ahorrar combustible.', correct: false } ],
                    feedbackCorrect: '¬°Correcto! El instructivo lo indica expl√≠citamente para evitar la rutina y prevenir acciones como observaci√≥n criminal o emboscadas.',
                    feedbackIncorrect: 'Incorrecto. Si bien conocer la jurisdicci√≥n es bueno, el objetivo principal de alternar rutas seg√∫n el instructivo es la seguridad operacional.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Ruta Habitual', icon: 'üõ£Ô∏è', color: 'text-red-600', text: 'Una patrulla debe realizar un desplazamiento diario a la misma hora por una v√≠a rural conocida por presencia de GAO. El comandante de patrulla decide usar siempre la misma ruta por ser la m√°s corta. ¬øEs correcta esta decisi√≥n?', options: [ { id: 'a', text: '(a) S√≠, si es la ruta m√°s r√°pida.' }, { id: 'b', text: '(b) No, el instructivo exige alternar rutas y horarios para evitar la rutina, especialmente en zonas de riesgo.' }, { id: 'c', text: '(c) S√≠, si la patrulla est√° bien armada.' }, { id: 'd', text: '(d) Solo si no hay alertas de inteligencia recientes.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. La rapidez no debe primar sobre la seguridad y la prevenci√≥n de rutinas.", 'b': "¬°Correcto! El Instructivo 013 es claro en la necesidad de alternar rutas y horarios para evitar la rutina, lo cual es cr√≠tico en zonas de riesgo.", 'c': "Incorrecto. El armamento no elimina el riesgo de emboscada facilitada por la rutina.", 'd': "Incorrecto. Aunque las alertas son importantes, la alternancia de rutas es una medida preventiva constante." } },
                     { id: 2, title: 'Escenario 2: Falta Disciplina T√°ctica', icon: 'üì±', color: 'text-yellow-600', text: 'Durante un desplazamiento en veh√≠culo policial por zona urbana, observa que el copiloto va distra√≠do usando su tel√©fono personal y el conductor no parece estar atento a los espejos laterales. ¬øQu√© principio del instructivo se est√° incumpliendo?', options: [ { id: 'a', text: '(a) La alternancia de rutas.' }, { id: 'b', text: '(b) La verificaci√≥n mec√°nica del veh√≠culo.' }, { id: 'c', text: '(c) La disciplina t√°ctica durante el desplazamiento (concentraci√≥n, observaci√≥n, roles).' }, { id: 'd', text: '(d) La coordinaci√≥n con FF.MM.' } ], correctAnswer: 'c', feedback: { 'a': "Incorrecto.", 'b': "Incorrecto.", 'c': "¬°Correcto! El Instructivo 013 exige disciplina t√°ctica: personal concentrado en seguridad y observaci√≥n. El uso del celular (tambi√©n mencionado aparte) y la falta de atenci√≥n violan este principio.", 'd': "Incorrecto." } }
                ],
                 summaryPoints: [ 'Evaluar uso de <strong>veh√≠culo uniformado/no uniformado</strong> y verificar <strong>estado mec√°nico</strong>.', 'Usar <strong>SIART (drones)</strong> si es viable y necesario.', '<strong>Alternar rutas y horarios</strong> para evitar rutina.', 'Mantener <strong>disciplina t√°ctica</strong> (concentraci√≥n, observaci√≥n, roles).', 'Coordinar <strong>acompa√±amiento y anillos de seguridad</strong> si el riesgo lo amerita.' ]
            },
            {
                id: 'autoproteccion',
                title: 'Autoprotecci√≥n Personal',
                menuIcon: svgIcons.autoproteccion,
                subtitle: 'Medidas Preventivas Individuales',
                protocolSteps: [
                    { title: 'Paso 1: Identificaci√≥n y Vestimenta', icon: 'üëï', color: 'text-blue-600', points: ['NO portar/llevar uniformes, prendas, documentos o elementos identificativos como polic√≠a en situaciones administrativas/fuera de servicio.'] },
                    { title: 'Paso 2: Elementos de Protecci√≥n (EPP)', icon: 'üõ°Ô∏è', color: 'text-green-600', points: ['Verificar uso de EPP (chaleco, casco bal√≠stico, equipo moto, etc.) de acuerdo al servicio.'] },
                    { title: 'Paso 3: Manejo de Sospechosos', icon: 'üì¶', color: 'text-orange-600', points: ['Instruir sobre aviso, alerta y actuaci√≥n ante paquetes/elementos/veh√≠culos abandonados.', 'Evitar manipulaci√≥n; acordonar y solicitar apoyo especializado.'] },
                    { title: 'Paso 4: Actuaci√≥n T√°ctica B√°sica', icon: 'üö∂‚Äç‚ôÇÔ∏è‚ÜîÔ∏èüö∂‚Äç‚ôÄÔ∏è', color: 'text-purple-600', points: ['Mantener medidas autoprotecci√≥n en atenci√≥n motivos polic√≠a.', 'Ser precavido, manejar distancia considerable (reacci√≥n).', 'Aplicar Sistema T√°ctico B√°sico (contacto y cubrimiento).'] },
                    { title: 'Paso 5: Reacci√≥n ante Ataque', icon: 'üí•', color: 'text-red-600', points: ['En caso de hostigamiento/ataque: Buscar protecci√≥n.', 'Aplicar plan defensa unidad.', 'Identificar origen amenaza.', 'Generar respuesta inmediata para contrarrestar.'] }
                ],
                 verificationQuestion: {
                    text: '¬øQu√© recomienda el Instructivo 013 sobre portar prendas que identifiquen como polic√≠a fuera del servicio?',
                    options: [ { text: 'Portarlas siempre con orgullo.', correct: false }, { text: 'No portarlas para prevenir actos contra la vida/integridad.', correct: true }, { text: 'Solo portar la gorra.', correct: false } ],
                    feedbackCorrect: '¬°Correcto! El instructivo es claro en evitar portar elementos identificativos fuera de servicio para prevenir riesgos.',
                    feedbackIncorrect: 'Incorrecto. Revisa el instructivo. La recomendaci√≥n es no portar elementos identificativos fuera de servicio por seguridad.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Paquete Abandonado', icon: 'üéí', color: 'text-orange-600', text: 'Durante un patrullaje, encuentra un morral abandonado cerca a la entrada de la estaci√≥n. ¬øCu√°l es la acci√≥n inicial correcta seg√∫n el instructivo?', options: [ { id: 'a', text: '(a) Abrir el morral cuidadosamente para verificar contenido.' }, { id: 'b', text: '(b) Levantar el morral y llevarlo a la oficina de objetos perdidos.' }, { id: 'c', text: '(c) No manipularlo, acordonar el √°rea y solicitar apoyo de la especialidad encargada (antedex/gu√≠as caninos).' }, { id: 'd', text: '(d) Preguntar a los transe√∫ntes si es de alguien.' } ], correctAnswer: 'c', feedback: { 'a': "¬°Muy Incorrecto! Nunca manipular un elemento sospechoso.", 'b': "Incorrecto. La manipulaci√≥n es riesgosa.", 'c': "¬°Correcto! El Instructivo 013 indica evitar manipulaci√≥n, acordonar y solicitar apoyo especializado ante elementos sospechosos/abandonados.", 'd': "Incorrecto. Preguntar puede alertar a un posible actor criminal o no ser efectivo; la prioridad es la seguridad." } },
                     { id: 2, title: 'Escenario 2: Atenci√≥n Motivo Polic√≠a', icon: 'üó£Ô∏è', color: 'text-purple-600', text: 'Al atender un caso de ri√±a en v√≠a p√∫blica, uno de los involucrados se muestra muy alterado y se acerca demasiado a usted mientras le grita. ¬øQu√© principio de autoprotecci√≥n del instructivo debe aplicar?', options: [ { id: 'a', text: '(a) Acercarse m√°s para demostrar autoridad.' }, { id: 'b', text: '(b) Ignorar la cercan√≠a y seguir hablando.' }, { id: 'c', text: '(c) Mantener una distancia considerable que permita reaccionar (Sistema T√°ctico B√°sico) y aplicar t√©cnicas de verbalizaci√≥n.' }, { id: 'd', text: '(d) Usar la fuerza f√≠sica inmediatamente.' } ], correctAnswer: 'c', feedback: { 'a': "Incorrecto. Acercarse m√°s aumenta el riesgo.", 'b': "Incorrecto. Ignorar la distancia de seguridad es riesgoso.", 'c': "¬°Correcto! El Instructivo 013 menciona mantener distancia considerable para reaccionar y aplicar el Sistema T√°ctico B√°sico en la atenci√≥n de motivos de polic√≠a.", 'd': "Incorrecto. El uso de la fuerza debe ser el √∫ltimo recurso y seguir los principios de necesidad, proporcionalidad, etc." } }
                ],
                 summaryPoints: [ '<strong>No portar prendas identificativas</strong> fuera de servicio.', 'Verificar uso de <strong>EPP</strong> seg√∫n servicio.', 'Actuar con precauci√≥n ante <strong>elementos sospechosos</strong> (no manipular, acordonar, solicitar apoyo).', 'Aplicar <strong>Sistema T√°ctico B√°sico</strong> (distancia, contacto/cubrimiento) al atender motivos.', 'Saber c√≥mo <strong>reaccionar ante ataques</strong> (protegerse, aplicar plan defensa, responder).' ]
            },
             {
                id: 'comunicaciones_info',
                title: 'Manejo Informaci√≥n y Comms',
                menuIcon: svgIcons.comunicaciones,
                subtitle: 'Seguridad Operacional',
                protocolSteps: [
                    { title: 'Paso 1: Seguridad de la Informaci√≥n en Documentos', icon: 'üîí', color: 'text-red-600', points: ['Garantizar que actos administrativos (√≥rdenes servicio/marcha/operaciones) cumplan pol√≠ticas seguridad informaci√≥n.', 'Minimizar riesgo de filtraci√≥n de detalles de desplazamientos/operativos.'] },
                    { title: 'Paso 2: Comunicaciones Efectivas', icon: 'üì°', color: 'text-blue-600', points: ['Establecer componente comunicaciones (radio, m√≥vil, satelital) efectivo.', 'Permitir seguimiento en tiempo real del desplazamiento.'] },
                    { title: 'Paso 3: Uso Restringido de Celular', icon: 'üìµ', color: 'text-orange-600', points: ['Evitar uso del tel√©fono celular DURANTE la prestaci√≥n del servicio.', 'Observar lo dispuesto en el instructivo 012 del 04/05/2020 (o norma vigente).'] },
                    { title: 'Paso 4: Socializaci√≥n y Concientizaci√≥n', icon: 'üì¢', color: 'text-green-600', points: ['Comandantes deben socializar e interiorizar temas de inter√©s, medidas autoprotecci√≥n, capacidad amenaza (explosivos, etc.).', 'Dejar evidencia de consignas impartidas.', 'Generar disciplina en actuaciones para salvaguardar vida e integridad.'] }
                ],
                 verificationQuestion: {
                    text: '¬øPermite el Instructivo 013 el uso libre del celular personal durante la prestaci√≥n del servicio?',
                    options: [ { text: 'S√≠, si es para llamadas importantes.', correct: false }, { text: 'No, recomienda evitarlo y observar instructivos espec√≠ficos sobre el tema.', correct: true }, { text: 'S√≠, no hay restricciones mencionadas.', correct: false } ],
                    feedbackCorrect: '¬°Correcto! El instructivo indica expl√≠citamente "Evitar el uso del tel√©fono celular durante la prestaci√≥n del servicio" y remite a otras normas.',
                    feedbackIncorrect: 'Incorrecto. Revisa el instructivo. Se recomienda evitar el uso del celular en servicio.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Orden de Servicio Detallada', icon: 'üìù', color: 'text-red-600', text: 'Se elabora una orden de servicio para un patrullaje en zona rural, detallando la ruta exacta, horarios de paso por puntos espec√≠ficos y nombres de todos los integrantes. Se imprime y se entrega f√≠sicamente a la patrulla. ¬øQu√© riesgo de seguridad de la informaci√≥n podr√≠a existir?', options: [ { id: 'a', text: '(a) Ninguno, la informaci√≥n es necesaria para la patrulla.' }, { id: 'b', text: '(b) El papel podr√≠a mojarse si llueve.' }, { id: 'c', text: '(c) La p√©rdida o sustracci√≥n del documento f√≠sico podr√≠a exponer detalles cr√≠ticos del operativo a actores criminales.' }, { id: 'd', text: '(d) El riesgo de que la impresora se quede sin tinta.' } ], correctAnswer: 'c', feedback: { 'a': "Incorrecto. Si bien la informaci√≥n es necesaria, su manejo f√≠sico detallado implica riesgos.", 'b': "Incorrecto.", 'c': "¬°Correcto! El Instructivo 013 pide cumplir pol√≠ticas de seguridad de la informaci√≥n en los actos administrativos. Un documento f√≠sico con tantos detalles es vulnerable a p√©rdida o filtraci√≥n, comprometiendo la seguridad operacional.", 'd': "Incorrecto." } },
                     { id: 2, title: 'Escenario 2: Falla de Radio', icon: 'üìª', color: 'text-yellow-600', text: 'Una patrulla se desplaza por una zona rural con se√±al de celular intermitente. El radio de comunicaciones principal presenta fallas. ¬øQu√© aspecto de la seguridad operacional se ve comprometido?', options: [ { id: 'a', text: '(a) La disciplina t√°ctica.' }, { id: 'b', text: '(b) La efectividad del componente de comunicaciones para seguimiento y solicitud de apoyo.' }, { id: 'c', text: '(c) La alternancia de rutas.' }, { id: 'd', text: '(d) El uso de EPP.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto.", 'b': "¬°Correcto! El Instructivo 013 resalta la necesidad de un componente de comunicaciones efectivo para seguimiento en tiempo real. Una falla compromete esta capacidad.", 'c': "Incorrecto.", 'd': "Incorrecto." } }
                ],
                 summaryPoints: [ 'Asegurar <strong>confidencialidad</strong> en documentos operativos (√≥rdenes).', 'Establecer <strong>comunicaciones efectivas</strong> para seguimiento y apoyo.', '<strong>Evitar uso de celular personal</strong> durante el servicio.', '<strong>Socializar y concientizar</strong> constantemente sobre riesgos y medidas.' ]
            }
        ];

        // --- L√≥gica de la Aplicaci√≥n (sin cambios funcionales) ---
        let currentModuleId = null;
        let currentStep = 1;
        let currentScenario = 1;
        let currentModuleData = {};

        // Funciones auxiliares (sin cambios)
        function showElement(id) { const el = document.getElementById(id); if (el) el.style.display = 'block'; }
        function hideElement(id) { const el = document.getElementById(id); if (el) el.style.display = 'none'; }
        function clearContainer(containerId) { const container = document.getElementById(containerId); if (container) container.innerHTML = ''; }

        // Inicializaci√≥n del Men√∫ Principal (Adaptada a Cards)
        function initializeMainMenu() {
            const menuContainer = document.getElementById('menu-cards-container');
            clearContainer('menu-cards-container');
            modulesData.forEach(module => {
                const card = document.createElement('div');
                card.className = 'menu-card';
                card.onclick = () => loadModule(module.id);
                card.innerHTML = `
                    <div class="menu-card-icon">${module.menuIcon || '‚ùì'}</div>
                    <h3 class="menu-card-title">${module.title}</h3>
                    <p class="menu-card-subtitle">${module.subtitle}</p>
                `;
                menuContainer.appendChild(card);
            });
            showElement('main-menu');
            hideElement('active-module');
        }

        // Cargar un M√≥dulo (Adaptada para resetear bot√≥n volver)
        function loadModule(moduleId) {
            currentModuleId = moduleId;
            currentModuleData = modulesData.find(m => m.id === moduleId);
            if (!currentModuleData) return;

            hideElement('main-menu');
            showElement('active-module');
            hideElement('protocolo');
            hideElement('escenarios');
            hideElement('resumen');
            hideElement('verification-question');

            document.getElementById('module-title').textContent = currentModuleData.title; // Usar t√≠tulo corto si se defini√≥ para card, o el largo
            document.getElementById('module-subtitle').textContent = currentModuleData.subtitle;

            buildProtocolSection();
            buildScenariosSection();
            buildSummarySection();

            showElement('protocolo');
            currentStep = 1;
            setActiveStep(currentStep);
        }

        // Construir Secci√≥n de Protocolo (Adaptada para botones nav)
        function buildProtocolSection() {
            const stepsContainer = document.getElementById('protocol-steps-container');
            clearContainer('protocol-steps-container');
            const totalSteps = currentModuleData.protocolSteps.length;

            currentModuleData.protocolSteps.forEach((step, index) => {
                const stepNumber = index + 1;
                const stepDiv = document.createElement('div');
                stepDiv.id = `step-${stepNumber}`;
                stepDiv.className = 'step-content mb-6 p-5 border rounded-lg bg-gray-50 shadow-sm';

                stepDiv.innerHTML = `
                    <h4 class="font-semibold text-lg mb-3 text-gray-700 flex items-center">
                       <span class="text-2xl mr-3 ${step.color || 'text-gray-500'}">${step.icon || ''}</span>
                       ${step.title}
                    </h4>
                    <ul class="list-disc list-inside text-gray-600 space-y-1 text-sm">
                        ${step.points.map(p => `<li>${p}</li>`).join('')}
                    </ul>
                    <div class="mt-6 flex justify-between">
                        <button onclick="prevStep(${stepNumber - 1})" class="nav-button secondary ${stepNumber === 1 ? 'invisible' : ''}">Anterior</button>
                        ${stepNumber === totalSteps
                            ? `<button onclick="showVerificationQuestion()" class="nav-button success">Verificar Comprensi√≥n</button>`
                            : `<button onclick="nextStep(${stepNumber + 1})" class="nav-button primary">Siguiente</button>`
                        }
                    </div>
                `;
                stepsContainer.appendChild(stepDiv);
            });

            // Construir pregunta de verificaci√≥n
            const vq = currentModuleData.verificationQuestion;
            document.getElementById('verification-question-text').textContent = vq.text;
            const vqOptionsContainer = document.getElementById('verification-options-container');
            clearContainer('verification-options-container');
            vq.options.forEach(opt => {
                const button = document.createElement('button');
                button.className = 'option-button';
                button.textContent = opt.text;
                button.onclick = () => checkVerificationAnswer(opt.correct, button);
                vqOptionsContainer.appendChild(button);
            });
            const vqFeedback = document.getElementById('verification-feedback');
            vqFeedback.style.display = 'none'; vqFeedback.textContent = ''; vqFeedback.className = 'feedback';
            document.getElementById('start-scenarios-btn').style.display = 'none';
        }

        // Construir Secci√≥n de Escenarios (Adaptada para botones nav)
        function buildScenariosSection() {
            const scenariosContainer = document.getElementById('scenarios-container');
            clearContainer('scenarios-container');
            if (!currentModuleData.scenarios || currentModuleData.scenarios.length === 0) {
                 scenariosContainer.innerHTML = '<p class="text-gray-500 text-center italic my-6">No hay escenarios de pr√°ctica disponibles para este m√≥dulo.</p>';
                 setTimeout(showSummary, 1500);
                return;
            }
            const totalScenarios = currentModuleData.scenarios.length;

            currentModuleData.scenarios.forEach((scenario, index) => {
                const scenarioNumber = index + 1;
                const scenarioDiv = document.createElement('div');
                scenarioDiv.id = `scenario-${scenarioNumber}`;
                scenarioDiv.className = 'scenario-content p-5 border rounded-lg bg-gray-50 mb-6 shadow-sm';

                scenarioDiv.innerHTML = `
                    <h4 class="font-semibold text-lg mb-3 text-gray-700 flex items-center">
                        <span class="text-2xl mr-3 ${scenario.color || 'text-gray-500'}">${scenario.icon || ''}</span>
                        ${scenario.title}
                    </h4>
                    <p class="text-gray-600 mb-4 text-sm">${scenario.text}</p>
                    <div id="options-scenario-${scenarioNumber}">
                        ${scenario.options.map(opt => `<button class="option-button" onclick="checkScenarioAnswer(${scenarioNumber}, '${opt.id}', this)">${opt.text}</button>`).join('')}
                    </div>
                    <div id="feedback-scenario-${scenarioNumber}" class="feedback"></div>
                    <div class="mt-6 text-right">
                        ${scenarioNumber === totalScenarios
                            ? `<button id="next-scenario-${scenarioNumber}" onclick="showSummary()" style="display:none;" class="nav-button success">Ver Resumen</button>`
                            : `<button id="next-scenario-${scenarioNumber}" onclick="nextScenario(${scenarioNumber + 1})" style="display:none;" class="nav-button primary">Siguiente Escenario</button>`
                        }
                    </div>
                `;
                scenariosContainer.appendChild(scenarioDiv);
                const feedbackEl = document.getElementById(`feedback-scenario-${scenarioNumber}`);
                feedbackEl.style.display = 'none'; feedbackEl.textContent = ''; feedbackEl.className = 'feedback';
                const nextButton = document.getElementById(`next-scenario-${scenarioNumber}`);
                if(nextButton) nextButton.style.display = 'none';
            });
        }

        // Construir Secci√≥n de Resumen (sin cambios estructurales)
        function buildSummarySection() {
            const summaryPointsList = document.getElementById('summary-points');
            clearContainer('summary-points');
             if (!currentModuleData.summaryPoints || currentModuleData.summaryPoints.length === 0) {
                 summaryPointsList.innerHTML = '<li class="text-gray-500 italic">Resumen no disponible.</li>';
                 return;
             }
            currentModuleData.summaryPoints.forEach(point => {
                const li = document.createElement('li');
                li.innerHTML = point;
                summaryPointsList.appendChild(li);
            });
        }

        // --- Funciones de Navegaci√≥n y L√≥gica (sin cambios funcionales) ---
        function setActiveStep(stepNumber) { document.querySelectorAll(`#protocol-steps-container .step-content`).forEach(el => el.classList.remove('active')); const el = document.getElementById(`step-${stepNumber}`); if (el) el.classList.add('active'); }
        function nextStep(stepNumber) { const totalSteps = currentModuleData.protocolSteps.length; if (stepNumber <= totalSteps) { currentStep = stepNumber; setActiveStep(currentStep); } }
        function prevStep(stepNumber) { if (stepNumber >= 1) { currentStep = stepNumber; setActiveStep(currentStep); } }

        function showVerificationQuestion() {
            const totalSteps = currentModuleData.protocolSteps.length;
            hideElement(`step-${totalSteps}`); showElement('verification-question');
            const vqOptionsContainer = document.getElementById('verification-options-container');
            vqOptionsContainer.querySelectorAll('.option-button').forEach(btn => { btn.disabled = false; btn.className = 'option-button'; });
            hideElement('verification-feedback'); hideElement('start-scenarios-btn');
        }

        function checkVerificationAnswer(isCorrect, buttonElement) {
            const feedbackEl = document.getElementById('verification-feedback');
            const allButtons = document.querySelectorAll('#verification-options-container .option-button');
            const vq = currentModuleData.verificationQuestion;
            allButtons.forEach(btn => { btn.disabled = true; btn.classList.remove('selected', 'correct-answer', 'incorrect-answer'); });
            buttonElement.classList.add('selected');
            if (isCorrect) {
                feedbackEl.textContent = vq.feedbackCorrect; feedbackEl.className = 'feedback correct'; showElement('start-scenarios-btn'); buttonElement.classList.add('correct-answer');
            } else {
                feedbackEl.textContent = vq.feedbackIncorrect; feedbackEl.className = 'feedback incorrect';
                allButtons.forEach(btn => { const opt = vq.options.find(o => o.text === btn.textContent); if (opt && opt.correct) btn.classList.add('correct-answer'); });
                buttonElement.classList.add('incorrect-answer');
            }
            feedbackEl.style.display = 'block';
        }

        function startScenarios() {
             if (!currentModuleData.scenarios || currentModuleData.scenarios.length === 0) { hideElement('protocolo'); showSummary(); }
             else { hideElement('protocolo'); showElement('escenarios'); currentScenario = 1; setActiveScenario(currentScenario); }
        }

        function setActiveScenario(scenarioNumber) {
            document.querySelectorAll(`#scenarios-container .scenario-content`).forEach(el => el.classList.remove('active'));
            const el = document.getElementById(`scenario-${scenarioNumber}`);
            if (el) {
                el.classList.add('active');
                el.querySelectorAll('.option-button').forEach(btn => { btn.disabled = false; btn.className = 'option-button'; });
                const fb = document.getElementById(`feedback-scenario-${scenarioNumber}`); if(fb) fb.style.display = 'none';
                const nb = document.getElementById(`next-scenario-${scenarioNumber}`); if(nb) nb.style.display = 'none';
            }
        }

        function checkScenarioAnswer(scenarioNum, selectedOptionId, buttonElement) {
            const scenarioData = currentModuleData.scenarios.find(s => s.id === scenarioNum); if (!scenarioData) return;
            const correctAnswerId = scenarioData.correctAnswer; const feedback = scenarioData.feedback[selectedOptionId];
            const feedbackEl = document.getElementById(`feedback-scenario-${scenarioNum}`);
            const nextButton = document.getElementById(`next-scenario-${scenarioNum}`);
            const allButtons = document.querySelectorAll(`#scenario-${scenarioNum} .option-button`);
            allButtons.forEach(btn => { btn.disabled = true; btn.classList.remove('selected', 'correct-answer', 'incorrect-answer'); });
            buttonElement.classList.add('selected'); feedbackEl.textContent = feedback;
            if (selectedOptionId === correctAnswerId) {
                feedbackEl.className = 'feedback correct'; buttonElement.classList.add('correct-answer');
            } else {
                feedbackEl.className = 'feedback incorrect'; buttonElement.classList.add('incorrect-answer');
                allButtons.forEach(btn => { const opt = scenarioData.options.find(o => o.id === correctAnswerId); if (opt && btn.textContent === opt.text) btn.classList.add('correct-answer'); });
            }
            feedbackEl.style.display = 'block'; if (nextButton) { nextButton.style.display = 'inline-block'; }
        }

        function nextScenario(scenarioNumber) { const totalScenarios = currentModuleData.scenarios.length; if (scenarioNumber <= totalScenarios) { currentScenario = scenarioNumber; setActiveScenario(currentScenario); } }
        function showSummary() { hideElement('escenarios'); hideElement('protocolo'); showElement('resumen'); }
        function restartCurrentModule() { if(currentModuleId) { loadModule(currentModuleId); } }
        function goToMainMenu() { hideElement('active-module'); showElement('main-menu'); currentModuleId = null; currentModuleData = {}; initializeMainMenu(); }

        // Inicializar al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', initializeMainMenu);
    </script>

<a href="https://ariasguerra.github.io/Seguridad%20Instalaciones/Index.html" 
   target="_self"
   title="Regresar al Portal Principal"
   class="fixed bottom-8 right-8 bg-blue-600 text-white w-16 h-16 rounded-full flex items-center justify-center shadow-lg hover:bg-blue-700 transition-transform transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M11 15l-3-3m0 0l3-3m-3 3h8M3 12a9 9 0 1118 0 9 9 0 01-18 0z" />
    </svg>
</a>
    
</body>
</html>
