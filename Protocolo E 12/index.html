<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entrenamiento Interactivo: Protocolo Seguridad E-12</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos generales y específicos para un look más profesional */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f7f6; /* Un gris muy claro, casi blanco */
        }
        #app-container {
            background-color: #ffffff;
            border-radius: 0.75rem; /* Esquinas más redondeadas */
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.04); /* Sombra más suave */
        }
        h1, h2, h3, h4 {
             color: #1f2937; /* gray-800 */
        }
        h2.text-blue-700 { /* Ajuste color títulos */
            color: #1d4ed8; /* blue-700 */
        }
        .module-content { display: none; position: relative; } /* Añadido position relative para botón volver */
        .step-content, .scenario-content { display: none; }
        .step-content.active, .scenario-content.active { display: block; }

        .feedback { display: none; margin-top: 1rem; padding: 0.75rem; border-radius: 0.5rem; font-size: 0.9rem; border-width: 1px; }
        .feedback.correct { background-color: #f0fdf4; border-color: #16a34a; color: #15803d; } /* Tailwind green-50, green-600, green-700 */
        .feedback.incorrect { background-color: #fef2f2; border-color: #dc2626; color: #b91c1c; } /* Tailwind red-50, red-600, red-700 */

        .option-button {
            display: block; width: 100%; text-align: left; margin-top: 0.75rem; padding: 0.875rem 1.25rem;
            border: 1px solid #d1d5db; /* gray-300 */ border-radius: 0.5rem; background-color: #ffffff;
            color: #374151; /* gray-700 */ font-weight: 500;
            transition: background-color 0.2s, border-color 0.2s, box-shadow 0.2s; cursor: pointer;
        }
        .option-button:hover:not(:disabled) {
            background-color: #f9fafb; /* gray-50 */ border-color: #9ca3af; /* gray-400 */
        }
         .option-button:disabled { cursor: not-allowed; opacity: 0.7; }
        .option-button.selected {
             border-color: #2563eb; /* blue-600 */ background-color: #eff6ff; /* blue-50 */
             font-weight: 600; color: #1e40af; /* blue-800 */
             box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3); /* Anillo azul sutil */
        }
         .option-button.correct-answer {
             border-color: #10b981; /* emerald-500 */ background-color: #ecfdf5; /* emerald-50 */ color: #047857; /* emerald-700 */
         }
         .option-button.incorrect-answer {
             border-color: #f87171; /* red-400 */ background-color: #fef2f2; /* red-50 */ color: #b91c1c; /* red-700 */
         }

         /* Estilo para las fichas del menú principal */
         .menu-card {
             display: flex; flex-direction: column; align-items: center;
             padding: 1.5rem; margin-bottom: 1rem; border: 1px solid #e5e7eb; /* gray-200 */
             border-radius: 0.75rem; background-color: #ffffff; /* Fondo blanco para contraste */
             text-align: center; cursor: pointer;
             transition: background-color 0.2s, box-shadow 0.3s, transform 0.2s; height: 100%;
             box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.05), 0 1px 2px 0 rgba(0, 0, 0, 0.03); /* Sombra muy sutil */
         }
         .menu-card:hover {
             background-color: #f9fafb; /* gray-50 */
             box-shadow: 0 4px 12px -1px rgba(0, 0, 0, 0.07), 0 2px 8px -1px rgba(0, 0, 0, 0.04); /* Sombra más pronunciada */
             transform: translateY(-3px); /* Efecto levantar mayor */
         }
         .menu-card-icon {
             font-size: 2.5rem; /* Tamaño ajustado */ margin-bottom: 1rem; color: #1d4ed8; /* blue-700 */
             background-color: #eff6ff; /* blue-50 */ padding: 0.75rem; border-radius: 50%; /* Círculo */
             width: 60px; height: 60px; display: inline-flex; align-items: center; justify-content: center;
         }
         .menu-card-icon svg { width: 100%; height: 100%; } /* Asegurar tamaño SVG */
         .menu-card-title {
             font-weight: 600; /* Semibold */ color: #111827; /* gray-900 */ font-size: 1rem; margin-bottom: 0.25rem;
         }
         .menu-card-subtitle { font-size: 0.875rem; color: #6b7280; /* gray-500 */ }

         /* Ajuste para listas dentro de pasos */
         .step-content ul { padding-left: 1.5rem; margin-top: 0.5rem; }
         .step-content ul li { margin-bottom: 0.3rem; }

         /* Botones de navegación */
         .nav-button {
             font-weight: 600; padding: 0.5rem 1.25rem; border-radius: 0.5rem; transition: background-color 0.2s, transform 0.1s;
         }
         .nav-button:hover { transform: scale(1.03); }
         .nav-button.primary { background-color: #2563eb; color: white; } /* blue-600 */
         .nav-button.primary:hover { background-color: #1d4ed8; } /* blue-700 */
         .nav-button.secondary { background-color: #e5e7eb; color: #374151; } /* gray-200, gray-700 */
         .nav-button.secondary:hover { background-color: #d1d5db; } /* gray-300 */
         .nav-button.success { background-color: #16a34a; color: white; } /* green-600 */
         .nav-button.success:hover { background-color: #15803d; } /* green-700 */

         /* Botón Volver al Menú */
        .back-to-menu-btn {
            position: absolute; top: 1.5rem; right: 1.5rem;
            background-color: #f3f4f6; /* gray-100 */ color: #4b5563; /* gray-600 */
            font-size: 0.8rem; font-weight: 500; padding: 0.3rem 0.8rem; border-radius: 9999px;
            transition: background-color 0.2s, color 0.2s; z-index: 10;
        }
        .back-to-menu-btn:hover { background-color: #e5e7eb; /* gray-200 */ color: #1f2937; /* gray-800 */ }

    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 p-4 md:p-8">

    <div id="app-container" class="max-w-5xl mx-auto bg-white rounded-lg shadow-xl p-6 md:p-10"> <div id="main-menu" class="text-center">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Centro de Entrenamiento Interactivo</h1>
            <h2 class="text-xl md:text-2xl font-semibold text-blue-700 mb-8">Protocolo Seguridad E-12 Barrios Unidos</h2>
            <p class="text-gray-600 mb-8">Selecciona el protocolo que deseas practicar:</p>
            <div id="menu-cards-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                </div>
        </div>

        <div id="active-module" class="module-content">
             <button onclick="goToMainMenu()" class="back-to-menu-btn">
                &larr; Volver al Menú
            </button>
            <h1 id="module-title" class="text-2xl md:text-3xl font-bold text-gray-800 mb-1 pt-8 md:pt-0"></h1>
            <h2 id="module-subtitle" class="text-lg md:text-xl font-semibold text-blue-700 mb-6"></h2>

            <div id="protocolo" style="display: none;">
                <h3 class="text-xl font-semibold text-gray-700 mb-4 border-b pb-2">Repaso del Protocolo</h3>
                <div id="protocol-steps-container">
                    </div>
                <div id="verification-question" style="display: none;" class="mt-6 p-5 border rounded-lg bg-blue-50">
                     <h4 class="font-bold text-lg mb-3 text-blue-800">¡Verifica tu Comprensión!</h4>
                     <p id="verification-question-text" class="mb-4 text-gray-700 font-medium"></p>
                     <div id="verification-options-container">
                         </div>
                     <div id="verification-feedback" class="feedback"></div>
                     <div class="mt-6 text-center">
                        <button id="start-scenarios-btn" onclick="startScenarios()" style="display:none;" class="nav-button success">
                            Iniciar Escenarios Simulados
                        </button>
                     </div>
                </div>
            </div>

            <div id="escenarios" style="display: none;">
                <h3 class="text-xl font-semibold text-gray-700 mb-4 border-b pb-2">Escenarios Simulados</h3>
                <div id="scenarios-container">
                    </div>
            </div>

            <div id="resumen" style="display: none;" class="p-6 border rounded-lg bg-blue-50 text-center">
                <h3 class="text-xl font-semibold text-blue-700 mb-4">Resumen del Módulo</h3>
                 <div id="summary-icon" class="flex justify-center space-x-4 my-5 text-4xl text-green-600">
                    <span>&#127941;</span> </div>
                <p class="text-gray-800 mb-4 font-semibold text-lg">¡Felicidades por completar el módulo!</p>
                <p class="font-medium mb-3 text-gray-700">Puntos Clave Recordados:</p>
                <ul id="summary-points" class="list-disc list-inside text-gray-600 space-y-1 mb-8 text-left inline-block">
                    </ul>
                 <div class="flex justify-center space-x-4">
                    <button onclick="restartCurrentModule()" class="nav-button secondary">
                        Reiniciar Módulo
                    </button>
                     <button onclick="goToMainMenu()" class="nav-button primary">
                        Menú Principal
                    </button>
                </div>
            </div>
        </div>

    </div>

    <script>
        // --- Iconos SVG (Placeholder - Reemplazar con iconos más específicos si se desea) ---
        const svgIcons = {
            peaton: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" /></svg>`,
            vehiculo: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0c-.563.058-.987.538-.987 1.106v.958m12.026 0h-2.25m0-3.182.08-.056a48.554 48.554 0 0 1 10.026 0 .08.056m-12.026 0h-2.25" /></svg>`,
            restringido: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636" /></svg>`,
            evento: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z" /></svg>`,
            arma: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l-4.995-4.995a2.652 2.652 0 0 1 0-3.751l3.75-3.75a2.652 2.652 0 0 1 3.751 0l4.995 4.995M11.42 15.17 14.25 18l1.406-1.406" /></svg>`, // Placeholder simple
            parqueadero: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75h12M8.25 18.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM20.25 18.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM12.75 5.25v11.25" /><path stroke-linecap="round" stroke-linejoin="round" d="M12.75 5.25v11.25M8.25 15 12 18.75l3.75-3.75M8.25 15 12 11.25l3.75 3.75M17.25 15h-1.5" /></svg>`, // Placeholder
            paquete: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9" /><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" /></svg>`,
            alojamiento: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" /></svg>`,
            // Añadir más iconos SVG si se necesitan para otros módulos
        };


        // --- Definición de Datos de los Módulos ---
        const modulesData = [
             // --- MÓDULO 1: ÁREAS RESTRINGIDAS ---
             {
                id: 'areas_restringidas',
                title: 'Acceso Áreas Restringidas',
                menuIcon: svgIcons.restringido,
                subtitle: 'Basado en Art. 44 (Res. 01675) y Protocolo E-12',
                protocolSteps: [
                    { title: 'Paso 1: Definición y Propósito', icon: '<span>&#128272;</span><span class="mx-2">&#128681;</span><span>&#128737;</span>', color: 'text-red-600', points: ['Áreas establecidas DENTRO de la instalación donde se ubican activos vitales.', 'Acceso limitado/restringido para prevenir ingreso no autorizado.', 'Objetivo: Evitar acciones violentas, sabotaje, destrucción o sustracción; proteger vida e integridad.'] },
                    { title: 'Paso 2: Control Estricto', icon: '<span>&#128270;</span><span class="mx-2">&#10060;</span><span>&#128100;</span>', color: 'text-orange-500', points: ['Permitir ÚNICAMENTE personal autorizado.', 'Evitar excepciones.', 'Si hay necesidad excepcional, SOLO el responsable del área puede autorizar ingreso.'] },
                    { title: 'Paso 3: Verificación y Acompañamiento (E-12)', icon: '<span>&#128222;</span><span class="mx-2">&#128064;</span><span>&#128110;</span>', color: 'text-blue-500', points: ['Realizar llamada para confirmar autorización antes de permitir ingreso.', 'Funcionario del área restringida DEBE acompañar y supervisar al visitante TODO el tiempo.', 'Prohibir uso de medios tecnológicos que pongan en riesgo la información.'] },
                    { title: 'Paso 4: Mecanismos y Registro', icon: '<span>&#128273;</span><span class="mx-2">&#128477;&#65039;</span><span>&#128211;</span>', color: 'text-green-500', points: ['Usar elementos para dificultar acceso no autorizado (cerraduras, biométrico, RFID).', 'Dejar registro del ingreso (autorizado o excepcional) en sistema o libro.', 'Diligenciar y firmar formatos de confidencialidad si aplica (procesos sensibles).'] }
                ],
                 verificationQuestion: {
                    text: 'Según el protocolo E-12, ¿qué se debe hacer ANTES de permitir el ingreso de un visitante a un área restringida, incluso si tiene autorización verbal?',
                    options: [ { text: 'Registrarlo en el libro solamente.', correct: false }, { text: 'Realizar una llamada para confirmar la autorización.', correct: true }, { text: 'Solicitarle que firme un documento de confidencialidad.', correct: false } ],
                    feedbackCorrect: '¡Correcto! El protocolo E-12 especifica realizar una llamada para confirmar la autorización antes del ingreso.',
                    feedbackIncorrect: 'Incorrecto. Si bien el registro y la confidencialidad son importantes, el protocolo E-12 enfatiza la llamada de confirmación previa.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Visitante con Portátil', icon: '<span>&#128100;</span><span class="mx-2">&#128187;</span><span>&#128681;</span>', color: 'text-yellow-600', text: 'Un técnico autorizado ingresa a un área restringida acompañado por un funcionario del área. El técnico saca su portátil para realizar el trabajo. ¿Es esto permitido?', options: [ { id: 'a', text: '(a) Sí, si es necesario para su trabajo.' }, { id: 'b', text: '(b) No, el protocolo E-12 prohíbe el uso de medios tecnológicos al visitante dentro del área restringida.' }, { id: 'c', text: '(c) Depende de si el funcionario acompañante lo autoriza.' }, { id: 'd', text: '(d) Solo si el portátil es institucional.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. Aunque sea necesario, el protocolo prima.", 'b': "¡Correcto! El protocolo E-12 para áreas restringidas prohíbe explícitamente el uso de medios tecnológicos por parte del visitante para evitar riesgos de seguridad de la información.", 'c': "Incorrecto. La autorización del acompañante no puede sobrepasar el protocolo establecido.", 'd': "Incorrecto. La prohibición es sobre el uso por parte del visitante, independientemente de la propiedad del equipo." } },
                     { id: 2, title: 'Escenario 2: Falta de Acompañamiento', icon: '<span>&#128100;</span><span class="mx-2">&#128110;</span><span>&#10060;</span>', color: 'text-red-600', text: 'Se autoriza el ingreso de un proveedor a un área restringida. El funcionario del área que debía acompañarlo está ocupado y le dice al personal de seguridad que deje ingresar al proveedor solo, que él ya sabe dónde ir. ¿Qué debe hacer el personal de seguridad?', options: [ { id: 'a', text: '(a) Permitir el ingreso solo, ya que el funcionario del área lo indicó.' }, { id: 'b', text: '(b) Negar el ingreso hasta que el funcionario del área esté disponible para acompañar al proveedor, según protocolo E-12.' }, { id: 'c', text: '(c) Dejarlo ingresar, pero vigilarlo por las cámaras.' }, { id: 'd', text: '(d) Buscar otro funcionario disponible para que lo acompañe.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. La indicación del funcionario no puede ir contra el protocolo.", 'b': "¡Correcto! El protocolo E-12 exige acompañamiento y supervisión constante del visitante en áreas restringidas. No se debe permitir el ingreso sin este acompañamiento.", 'c': "Incorrecto. La vigilancia por cámaras no reemplaza el acompañamiento físico exigido.", 'd': "Incorrecto. La responsabilidad del acompañamiento recae en el área visitada; si no hay nadie, no debe ingresar." } }
                ],
                 summaryPoints: [ 'Las áreas restringidas requieren <strong>control estricto</strong> y solo acceso autorizado (Art. 44).', 'La <strong>autorización excepcional</strong> la da solo el responsable del área (Art. 44).', 'Protocolo E-12 exige <strong>llamada de confirmación</strong> previa y <strong>acompañamiento constante</strong>.', 'Se prohíbe el uso de <strong>medios tecnológicos</strong> por visitantes en áreas restringidas (E-12).', 'Todo ingreso debe ser <strong>registrado</strong> (Art. 44).' ]
            },
            // --- MÓDULO 2: ACCESO PEATONAL ---
            {
                id: 'peatonal',
                title: 'Acceso Peatonal',
                menuIcon: svgIcons.peaton,
                subtitle: 'Protocolo General y Específico E-12',
                protocolSteps: [
                    { title: 'Paso 1: Identificación y Verificación', icon: '<span>&#128195;</span> <span class="mx-2">&#128270;</span> <span>&#9888;&#65039;</span>', color: 'text-blue-500', points: ['Saludo institucional.', 'Identificación (3 fases: Identificar, Autentificar, Autorizar) - Cédula, Pasaporte, Carné Policial.', 'Porte VISIBLE y VIGENTE de carné institucional (uniformados/no uniformados E-12).', 'Verificación de antecedentes (SICOVI u otro).', 'Comprobar autorización de ingreso (listados previos si aplica).'] },
                    { title: 'Paso 2: Registro Físico y de Elementos', icon: '<span>&#128110;</span> <span class="mx-2">&#128187;</span> <span>&#128021;</span>', color: 'text-orange-500', points: ['Registro a personas (uniformados y particulares - Ley 1801 Art. 159).', 'Verificar armas/elementos peligrosos.', 'Si porta arma: Manejo en tubo descargue, custodia en armerillo transitorio, registro SICOVI/libro, entrega ficha.', 'Registro físico/tecnológico (Rayos X, Garrett) de elementos (bolsos, paquetes, etc.) al ingreso Y SALIDA.', 'Computadores/Tablets: Registrar ingreso/salida en SICOVI/libro. Salida de elementos requiere autorización dependencia.'] },
                    { title: 'Paso 3: Asignación y Control de Visitantes', icon: '<span>&#127915;</span> <span class="mx-2">&#9200;</span> <span>&#128101;</span>', color: 'text-green-500', points: ['Registrar visitante en SICOVI/libro.', 'Asignar FICHA según piso (Azul: 1°, Amarilla: 2°, Roja: 3°). Porte visible obligatorio.', 'Informar restricciones de acceso a zonas no autorizadas.', 'Verificar acompañamiento por funcionario del área visitada (ingreso y salida).', 'Comprobar salida del visitante.'] },
                    { title: 'Paso 4: Horarios y Casos Especiales', icon: '<span>&#9200;</span> <span class="mx-2">&#128118;</span> <span>&#128101;&#10133;</span>', color: 'text-purple-500', points: ['Horario Visitantes: L-D 08-12h y 14-18h. Fuera de horario requiere coordinación.', 'Eventos >10 personas: Listado previo (24h antelación). Dependencia responsable asigna funcionario.', 'NNA: Registrar en SICOVI/libro, control del responsable.', 'Trato preferencial: Gestantes, adultos mayores, discapacitados.', 'Contratistas/Practicantes/Mantenimiento: Identificación minuciosa, verificación antecedentes, ACOMPAÑAMIENTO OBLIGATORIO.', 'Vendedores: Autorización Comandante E-12, antecedentes, acompañamiento, perímetro definido.'] },
                    { title: 'Paso 5: Restricciones y Prohibiciones (E-12)', icon: '<span>&#10060;</span> <span class="mx-2">&#128299;</span> <span>&#128245;</span>', color: 'text-red-500', points: ['Restringido ingreso elementos por rejas/muros/ventanas.', 'Prohibido ingreso/salida peatonal por acceso vehicular.', 'No forzar puertas; mantenerlas cerradas.', 'Control de balcones/ventanas por jefe de oficina/más antiguo.', 'Prohibido consumo alimentos en oficinas (solo zonas designadas).', 'Prohibido consumo alimentos en perímetro por vendedores informales (riesgo).', 'Prohibido ingreso con animales (excepto asistencia).', 'Restringido ingreso dispositivos almacenamiento/comunicación (pueden requerir dejarse en recepción, especialmente para Comando/Subcomando/áreas sensibles).'] }
                ],
                verificationQuestion: {
                    text: 'Según el protocolo E-12, ¿qué se debe hacer con el computador portátil de un visitante al ingresar?',
                    options: [ { text: 'No se permite su ingreso.', correct: false }, { text: 'Se permite sin registro.', correct: false }, { text: 'Debe ser registrado (ingreso y salida) en SICOVI o libro.', correct: true } ],
                    feedbackCorrect: '¡Correcto! El protocolo E-12 especifica que los elementos tecnológicos como portátiles deben ser registrados al ingreso y verificar su salida.',
                    feedbackIncorrect: 'Incorrecto. Revisa el protocolo E-12 sobre el manejo de elementos tecnológicos. Se exige registro.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Visitante sin Carné Visible', icon: '<span>&#128100;</span> <span class="mx-2">&#127915;</span> <span>&#128065;</span>', color: 'text-yellow-600', text: 'Un visitante ingresa, se le asigna la ficha correspondiente al piso 2 (amarilla), pero usted lo observa caminando por el pasillo del piso 3 sin la ficha visible. ¿Qué acción toma?', options: [ { id: 'a', text: '(a) Ignorarlo, ya está adentro.' }, { id: 'b', text: '(b) Abordarlo cortésmente, solicitarle que porte la ficha visible y recordarle que solo tiene acceso autorizado al piso 2.' }, { id: 'c', text: '(c) Llamar al funcionario que lo acompaña para que lo controle.' }, { id: 'd', text: '(d) Informar al Comandante de Guardia para que tome medidas.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. La seguridad interna implica verificar el cumplimiento de normas.", 'b': "¡Correcto! Se debe corregir la falta (porte visible de ficha) y recordar la restricción de acceso según la ficha asignada (Protocolo E-12).", 'c': "Incorrecto. Si bien el acompañante es responsable, el personal de seguridad también debe actuar al detectar una irregularidad.", 'd': "Incorrecto. Es una situación que usualmente puede manejar el personal de seguridad directamente antes de escalar, salvo reincidencia o desacato." } },
                     { id: 2, title: 'Escenario 2: Salida con Paquete', icon: '<span>&#128104;&#8205;&#128110;</span> <span class="mx-2">&#128230;</span> <span>&#128270;</span>', color: 'text-orange-600', text: 'Un funcionario de la estación se dispone a salir al finalizar su turno llevando una caja sellada. ¿Cuál es el procedimiento correcto según el protocolo E-12?', options: [ { id: 'a', text: '(a) Dejarlo salir sin revisión por ser funcionario.' }, { id: 'b', text: '(b) Solicitarle amablemente que permita revisar el contenido de la caja para prevenir sustracción de activos vitales y registrar la salida del elemento si corresponde.' }, { id: 'c', text: '(c) Solo revisar si parece sospechoso.' }, { id: 'd', text: '(d) Pedirle una autorización escrita de su jefe para sacar la caja.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. El protocolo E-12 exige registro de elementos también a la salida.", 'b': "¡Correcto! El protocolo E-12 (Protocolo General, punto 15) indica que se debe efectuar registro físico a bolsos, paquetes, etc., de TODO el personal que salga para evitar sustracción de activos.", 'c': "Incorrecto. La revisión a la salida aplica a todos los elementos según el protocolo, no solo a los sospechosos.", 'd': "Incorrecto. Si bien una autorización podría ser necesaria para sacar activos institucionales, el primer paso es el registro físico del elemento." } }
                ],
                summaryPoints: [ 'La <strong>identificación y verificación</strong> (3 fases) son rigurosas (E-12).', 'El <strong>carné policial</strong> debe portarse visible (E-12).', 'El <strong>registro de elementos</strong> aplica al ingreso Y SALIDA (E-12).', 'Las <strong>fichas de colores</strong> indican el piso autorizado (E-12).', 'Existen <strong>horarios</strong> y procedimientos claros para visitantes, eventos y casos especiales (E-12).', 'Hay <strong>restricciones específicas</strong> sobre elementos, acceso por puertas no autorizadas y comportamiento (E-12).' ]
            },
             // --- MÓDULO 3: ACCESO VEHICULAR ---
            {
                id: 'vehicular',
                title: 'Acceso Vehicular y Bicis',
                menuIcon: svgIcons.vehiculo,
                subtitle: 'Protocolo Específico E-12',
                protocolSteps: [
                    { title: 'Paso 1: Abordaje Inicial', icon: '<span>&#128663;</span><span class="mx-2">&#128737;</span><span>&#128100;</span>', color: 'text-blue-500', points: ['Saludo institucional.', 'Solicitud de apagado del vehículo.', 'Identificación conductor, tripulantes y documentos vehículo (cédula, licencias, carné policial, etc.).'] },
                    { title: 'Paso 2: Verificación y Autorización', icon: '<span>&#128270;</span><span class="mx-2">&#128196;</span><span>&#9989;</span>', color: 'text-teal-500', points: ['Verificación de antecedentes (conductor/tripulantes).', 'Comprobar autorización de ingreso (listados previos si aplica).'] },
                    { title: 'Paso 3: Registro Físico', icon: '<span>&#128270;</span><span class="mx-2">&#128663;</span><span>&#128021;</span>', color: 'text-orange-500', points: ['Solicitar descenso conductor y COPILOTO (E-12) (salvo excepciones autorizadas).', 'Registro a personas (conductor/copiloto).', 'Registro físico vehículo/moto (cabina, baúl, motor, etc.) con espejo convexo, binomio canino (si hay). Aplica al INGRESO y SALIDA.', 'Registrar información visitante/vehículo en SICOVI/libro.'] },
                    { title: 'Paso 4: Ingreso Controlado', icon: '<span>&#128678;</span><span class="mx-2">&#128659;</span><span>&#128285;</span>', color: 'text-red-500', points: ['Solo el CONDUCTOR ingresa el vehículo a zona autorizada.', 'Asignar ficha y lugar de aparcamiento (visitantes).', 'Motocicletas/bicicletas: Ingresar SIN casco/pasamontañas/cuellero, llevando vehículo de la mano.', 'Velocidad máxima: 10 km/h.', 'Prohibido lavar vehículos.'] },
                    { title: 'Paso 5: Bici-usuarios (E-12)', icon: '<span>&#128692;</span><span class="mx-2">&#127915;</span><span>&#128207;</span>', color: 'text-indigo-500', points: ['Visitante/Proveedor: Permitir registro, acompañamiento dependencia, presentar ficha.', 'Funcionario: Presentar carné, verificar sistema. Visitante: Cédula, registrar libro, entregar ficha parqueo.', 'Parqueo visitante sujeto a disponibilidad.', 'Portar elementos protección (Ley 769/2002).'] }
                ],
                 verificationQuestion: {
                    text: 'Según el protocolo E-12, al ingresar un vehículo, ¿quiénes deben descender para el registro?',
                    options: [ { text: 'Solo el conductor.', correct: false }, { text: 'El conductor y el copiloto.', correct: true }, { text: 'Todos los ocupantes.', correct: false } ],
                    feedbackCorrect: '¡Correcto! El protocolo E-12 especifica que deben descender el conductor y el copiloto para el registro.',
                    feedbackIncorrect: 'Incorrecto. Revisa el protocolo E-12 para acceso vehicular. Se especifica el descenso del conductor y copiloto.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Salida Sin Revisión', icon: '<span>&#128663;</span><span class="mx-2">&#128270;</span><span>&#10060;</span>', color: 'text-red-600', text: 'Un vehículo de un funcionario, que ingresó en la mañana, se dispone a salir. El funcionario saluda y arranca. ¿Debió realizar alguna acción adicional el personal de seguridad?', options: [ { id: 'a', text: '(a) No, la revisión es solo al ingreso.' }, { id: 'b', text: '(b) Sí, debió solicitar la revisión física del vehículo también a la salida para evitar sustracción de activos.' }, { id: 'c', text: '(c) Solo si el baúl parecía muy cargado.' }, { id: 'd', text: '(d) Solo verificar que la ficha de parqueo fuera correcta.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. El protocolo E-12 indica revisión al ingreso y salida.", 'b': "¡Correcto! El protocolo E-12 (Acceso Vehicular, punto 8) especifica que el registro físico del vehículo se realiza al ingreso y a la salida.", 'c': "Incorrecto. La revisión a la salida es estándar, no basada en sospechas.", 'd': "Incorrecto. La ficha es para el control de parqueo, no reemplaza la revisión de salida." } },
                     { id: 2, title: 'Escenario 2: Bici-usuario Visitante', icon: '<span>&#128692;</span><span class="mx-2">&#128100;</span><span>&#127915;</span>', color: 'text-indigo-600', text: 'Llega un visitante en bicicleta. ¿Cuál es el procedimiento correcto para su ingreso según el protocolo E-12?', options: [ { id: 'a', text: '(a) Permitirle ingresar conduciendo hasta el parqueadero de bicicletas.' }, { id: 'b', text: '(b) Solicitarle identificación (cédula), registrarlo en el libro, entregarle ficha de parqueo y permitirle llevar la bicicleta de la mano hasta el parqueadero (si hay disponibilidad).' }, { id: 'c', text: '(c) Indicarle que debe dejar la bicicleta afuera de las instalaciones.' }, { id: 'd', text: '(d) Registrarlo pero no entregarle ficha, ya que es una bicicleta.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. Debe ingresar llevando la bicicleta de la mano.", 'b': "¡Correcto! El protocolo E-12 para bici-usuarios visitantes exige identificación, registro, entrega de ficha y llevar la bici de la mano, sujeto a disponibilidad de parqueo.", 'c': "Incorrecto. El protocolo contempla el ingreso controlado, no la prohibición.", 'd': "Incorrecto. El protocolo menciona la entrega de ficha también para bicicletas." } }
                ],
                 summaryPoints: [ 'La <strong>identificación y verificación</strong> de conductor, ocupantes y vehículo es clave (E-12).', 'El <strong>registro físico</strong> del vehículo es al INGRESO y SALIDA (E-12).', 'Deben descender <strong>conductor y copiloto</strong> para el registro (E-12).', 'Existen normas de <strong>ingreso controlado</strong> (velocidad, casco, llevar vehículo de mano) (E-12).', 'Los <strong>bici-usuarios</strong> tienen un procedimiento específico de registro y parqueo (E-12).' ]
            },
             // --- MÓDULO 4: VISITAS ESPECIALES / EVENTOS ---
            {
                id: 'visitas_especiales',
                title: 'Visitas Especiales / Eventos',
                menuIcon: svgIcons.evento,
                subtitle: 'Protocolo Específico E-12',
                protocolSteps: [
                    { title: 'Paso 1: Coordinación Previa (E-12)', icon: '<span>&#128197;</span><span class="mx-2">&#128221;</span><span>&#128101;</span>', color: 'text-blue-500', points: ['Responsable del evento informa PREVIAMENTE (24h antelación si >10 pers.) al Jefe de Seguridad.', 'Anexar listado detallado (asistentes, ID, E/S, motivo, entidad, placas, quién recibe).', 'Formato específico proporcionado en el protocolo E-12.'] },
                    { title: 'Paso 2: Registro y Acompañamiento', icon: '<span>&#128214;</span><span class="mx-2">&#128100;</span><span>&#128279;</span>', color: 'text-green-500', points: ['Registrar ingreso según listado.', 'Acompañantes socializan plan emergencia/evacuación.', 'Asegurar acompañamiento ingreso/egreso.', 'Dependencia convocante coordina apoyo a seguridad para evitar que asistentes merodeen (E-12).'] },
                    { title: 'Paso 3: Manejo Esquemas de Seguridad (E-12)', icon: '<span>&#128737;</span><span class="mx-2">&#128299;</span><span>&#128681;</span>', color: 'text-orange-500', points: ['Ubicar esquema en lugar determinado (parqueadero).', 'Verificar armas/elementos peligrosos. Aplicar Art. 50.', 'Solo se permite ingreso de UNA persona de protección del esquema con su armamento (E-12).'] },
                    { title: 'Paso 4: Visitas Sin Previo Aviso', icon: '<span>&#9200;</span><span class="mx-2">&#10067;</span><span>&#128222;</span>', color: 'text-yellow-600', points: ['Seguridad comunica INMEDIATAMENTE a responsable seguridad.', 'Oficial/Suboficial de Servicio o Cte Guardia atiende hasta autorización dependencia.', 'Registrar si se autoriza.'] },
                    { title: 'Paso 5: Horarios y Casos Particulares', icon: '<span>&#127988;</span><span class="mx-2">&#128118;</span><span>&#128738;</span>', color: 'text-purple-500', points: ['Horario actividades: 07-12h y 14-18h (salvo manejo preferencial) (E-12).', 'Misiones diplomáticas: Aplicar Decreto 615/1935.', 'Eventos con NNA: Autorización Cte E-12 y consentimiento padres.', 'Eventos masivos: Implementar acciones adicionales protección.'] }
                ],
                 verificationQuestion: {
                    text: 'Según el protocolo E-12, ¿cuántos miembros del esquema de seguridad de una visita especial pueden ingresar armados a la instalación?',
                    options: [ { text: 'Todos los miembros del esquema.', correct: false }, { text: 'Ninguno, deben dejar todas las armas.', correct: false }, { text: 'Solo una persona de protección del esquema.', correct: true } ],
                    feedbackCorrect: '¡Correcto! El protocolo E-12 (Visitas Especiales, punto 4) especifica que solo se permite el ingreso de UNA persona de protección del esquema con su armamento.',
                    feedbackIncorrect: 'Incorrecto. Revisa el protocolo E-12 para Visitas Especiales, punto 4. Hay una limitación específica.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Evento sin Listado', icon: '<span>&#128101;</span><span class="mx-2">&#128221;</span><span>&#10060;</span>', color: 'text-red-600', text: 'Una dependencia organiza una capacitación para 20 personas externas e informa verbalmente a la guardia minutos antes, sin enviar el listado requerido con 24h de antelación. ¿Qué debe hacer la guardia?', options: [ { id: 'a', text: '(a) Permitir el ingreso de todos para no retrasar la capacitación.' }, { id: 'b', text: '(b) Negar el ingreso a todos por incumplimiento del protocolo.' }, { id: 'c', text: '(c) Informar al Jefe de Seguridad/Oficial de Servicio sobre el incumplimiento. Mientras tanto, solicitar a la dependencia responsable que envíe el listado urgentemente y realizar el registro individual de cada asistente verificando antecedentes, lo cual puede causar demoras.' }, { id: 'd', text: '(d) Dejar ingresar solo a 10 personas.' } ], correctAnswer: 'c', feedback: { 'a': "Incorrecto. Permitir el ingreso sin el listado y la coordinación previa viola el protocolo.", 'b': "Incorrecto. Aunque hay incumplimiento, negar el acceso totalmente puede no ser la primera medida; se debe informar y tratar de subsanar.", 'c': "¡Correcto! Se debe informar la novedad al superior. Exigir el listado a la dependencia responsable y proceder con el registro individual (aunque demore) es la forma de intentar cumplir el control a pesar del fallo inicial de coordinación.", 'd': "Incorrecto. El protocolo no establece esa medida." } },
                     { id: 2, title: 'Escenario 2: Asistentes Deambulando', icon: '<span>&#128101;</span><span class="mx-2">&#128694;</span><span>&#128681;</span>', color: 'text-yellow-600', text: 'Durante una reunión convocada por una dependencia interna con personal externo, observa a varios de los asistentes caminando por pasillos y áreas no relacionadas con la reunión. ¿De quién es la responsabilidad principal de controlar esto según el protocolo E-12?', options: [ { id: 'a', text: '(a) Exclusivamente del personal de seguridad de la guardia.' }, { id: 'b', text: '(b) De la dependencia que convocó la reunión, que debió coordinar apoyo a seguridad o asignar un responsable para evitarlo.' }, { id: 'c', text: '(c) De los propios asistentes, que deben conocer las normas.' }, { id: 'd', text: '(d) Del Jefe de Seguridad de Instalaciones únicamente.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. Aunque seguridad apoya, la responsabilidad primaria recae en quien convoca.", 'b': "¡Correcto! El protocolo E-12 (Visitas Especiales, punto 9) indica que la dependencia que convoca debe coordinar apoyo a seguridad para que los asistentes no merodeen.", 'c': "Incorrecto. No se puede asumir que los visitantes externos conocen todas las restricciones internas.", 'd': "Incorrecto. El Jefe de Seguridad supervisa, pero la ejecución del control en el evento recae en la dependencia organizadora." } }
                ],
                 summaryPoints: [ 'La <strong>coordinación previa</strong> (24h si >10 pers.) y envío de <strong>listado detallado</strong> es crucial (E-12).', 'La <strong>dependencia que convoca</strong> es responsable del acompañamiento y de evitar que los asistentes deambulen (E-12).', 'Solo <strong>UN miembro del esquema</strong> de seguridad puede ingresar armado (E-12).', 'Las <strong>visitas sin previo aviso</strong> requieren comunicación y autorización interna (E-12).', 'Hay <strong>horarios definidos</strong> para eventos (07-12h, 14-18h) (E-12).' ]
            },
             // --- MÓDULO 5: UNIDADES DE APOYO ---
            {
                id: 'unidades_apoyo',
                title: 'Acceso Unidades de Apoyo',
                menuIcon: svgIcons.peaton, // Reusar icono peaton (policía)
                subtitle: 'Protocolo Específico E-12',
                protocolSteps: [
                    { title: 'Paso 1: Coordinación y Documentación', icon: '<span>&#128104;&#8205;&#128110;</span><span class="mx-2">&#128197;</span><span>&#128221;</span>', color: 'text-blue-500', points: ['Apoyos coordinados PREVIAMENTE.', 'Verificar documentación soporte (directiva, orden servicio, etc.).'] },
                    { title: 'Paso 2: Verificación y Registro', icon: '<span>&#128270;</span><span class="mx-2">&#128101;</span><span>&#128214;</span>', color: 'text-green-500', points: ['Responsable seguridad contacta mando del apoyo para verificar.', 'Registrar ingreso (formato E-12: GR, Nombres, Cédula, Teléfono, Fecha/Hora Ingreso, Dependencia, Unidad Origen).'] },
                    { title: 'Paso 3: Control de Armas (E-12)', icon: '<span>&#128299;</span><span class="mx-2">&#10060;</span><span>&#128274;</span>', color: 'text-red-600', points: ['PROHIBIDO ingreso de armas personales (traumáticas o de fuego).', 'Deben entregarse al armerillo transitorio.'] },
                    { title: 'Paso 4: Instrucción Obligatoria', icon: '<span>&#128218;</span><span class="mx-2">&#128172;</span><span>&#9888;&#65039;</span>', color: 'text-purple-500', points: ['Dar instrucción sobre: Plan Defensa, plan evacuación, actuación emergencias, protocolos seguridad LOCALES.'] },
                    { title: 'Paso 5: Permanencia y Otros', icon: '<span>&#127968;</span><span class="mx-2">&#9200;</span><span>&#128738;</span>', color: 'text-orange-500', points: ['Si no se alojan: Coordinar instalación de su propio dispositivo seguridad (previa autorización).', 'Si llega alto número: Implementar acciones ADICIONALES protección.', 'Personal fuera de servicio: Máximo hasta 00:00 hrs en instalaciones (E-12).'] }
                ],
                 verificationQuestion: {
                    text: 'Según el protocolo E-12, ¿puede el personal de una unidad de apoyo ingresar con sus armas de fuego personales?',
                    options: [ { text: 'Sí, si están uniformados.', correct: false }, { text: 'No, está prohibido y deben dejarlas en el armerillo transitorio.', correct: true }, { text: 'Solo si vienen para un operativo.', correct: false } ],
                    feedbackCorrect: '¡Correcto! El protocolo E-12 (Unidades de Apoyo, punto 3) prohíbe explícitamente el ingreso de armas personales (fuego o traumáticas) y exige su custodia.',
                    feedbackIncorrect: 'Incorrecto. Revisa el protocolo E-12 para Unidades de Apoyo, punto 3. Hay una prohibición clara sobre armas personales.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Registro de Datos', icon: '<span>&#128104;&#8205;&#128110;</span><span class="mx-2">&#128214;</span><span>&#9997;</span>', color: 'text-green-600', text: 'Llega un grupo de apoyo coordinado. Al realizar el registro, el personal de seguridad solo anota el nombre del comandante del grupo y el número total de efectivos. ¿Es suficiente este registro según el formato del protocolo E-12?', options: [ { id: 'a', text: '(a) Sí, es suficiente para el control.' }, { id: 'b', text: '(b) No, el formato del protocolo E-12 exige registrar individualmente: GR, Apellidos/Nombres, Cédula, Teléfono, Fecha/Hora Ingreso, Dependencia y Unidad Origen de CADA miembro del apoyo.' }, { id: 'c', text: '(c) Solo falta registrar la unidad de origen.' }, { id: 'd', text: '(d) Solo se requiere el registro individual si se van a alojar.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. El protocolo E-12 muestra un formato detallado.", 'b': "¡Correcto! El protocolo E-12 (Unidades de Apoyo, punto 2) incluye una tabla que detalla la información individual requerida para el registro de cada miembro del apoyo.", 'c': "Incorrecto. Faltan más datos individuales según el formato.", 'd': "Incorrecto. El registro detallado aplica al ingreso del apoyo, independientemente del alojamiento." } },
                     { id: 2, title: 'Escenario 2: Permanencia Tarde', icon: '<span>&#128104;&#8205;&#128110;</span><span class="mx-2">&#127769;</span><span>&#9200;</span>', color: 'text-yellow-600', text: 'Son las 01:00 hrs. Durante una ronda, encuentra a dos miembros de una unidad de apoyo (que no están de servicio) en la cafetería de la estación. ¿Qué debería hacer?', options: [ { id: 'a', text: '(a) No hacer nada, están dentro de la estación.' }, { id: 'b', text: '(b) Recordarles que, según el protocolo E-12, el personal que no está de servicio debe estar en sus alojamientos o fuera de la instalación después de las 00:00 hrs, e informar la novedad.' }, { id: 'c', text: '(c) Ofrecerles un café.' }, { id: 'd', text: '(d) Verificar si tienen permiso especial del Comandante.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. Hay una norma de permanencia.", 'b': "¡Correcto! El protocolo E-12 (Unidades de Apoyo, punto 7) establece las 00:00 hrs como límite de permanencia en áreas comunes para personal fuera de servicio. Se debe recordar la norma e informar.", 'c': "Incorrecto.", 'd': "Incorrecto. La norma es clara, un permiso especial sería una excepción que debería conocerse previamente." } }
                ],
                 summaryPoints: [ 'La <strong>coordinación previa</strong> y <strong>verificación documental</strong> son esenciales (E-12).', 'El <strong>registro individual detallado</strong> es obligatorio (E-12).', 'Prohibido el ingreso de <strong>armas personales</strong> (fuego/traumáticas) (E-12).', 'La <strong>instrucción sobre planes locales</strong> es mandatoria (E-12).', 'Personal fuera de servicio tiene <strong>límite de permanencia</strong> (00:00 hrs) (E-12).' ]
            },
             // --- MÓDULO 6: CONTROL DE ARMAS ---
            {
                id: 'control_armas',
                title: 'Control de Armas',
                menuIcon: svgIcons.arma,
                subtitle: 'Protocolo Específico E-12 (Similar Art. 50)',
                protocolSteps: [
                    { title: 'Paso 1: Prohibición General', icon: '<span>&#128299;</span><span class="mx-2">&#10060;</span><span>&#128737;</span>', color: 'text-red-600', points: ['NO autorizado porte de armas (fuego, taser, etc.) dentro de instalaciones.', 'Excepción: Personal de seguridad instalaciones.', 'Excepción: Personal de planta que finaliza servicio y entrega en armerillos.', 'Excepción MUY específica: UNA persona de protección de esquema de visita especial (Protocolo Visitas).'] },
                    { title: 'Paso 2: Custodia Obligatoria', icon: '<span>&#128274;</span><span class="mx-2">&#128230;</span><span>&#128214;</span>', color: 'text-orange-500', points: ['Disponer espacio apropiado (armerillo transitorio / casillero con cerradura) para almacenar armas de visitantes (particulares, uniformados de otras unidades).', 'Garantizar seguridad (evitar pérdida/manipulación).'] },
                    { title: 'Paso 3: Manejo y Registro (E-12)', icon: '<span>&#128299;</span><span class="mx-2">&#128211;</span><span>&#127915;</span>', color: 'text-blue-500', points: ['Realizar manejo de seguridad en TUBO DE DESCARGUE antes de entregarla.', 'Registrar TODA arma guardada en SICOVI o libro.', 'Entregar FICHA de custodia al propietario.'] }
                ],
                 verificationQuestion: {
                    text: 'Según el protocolo E-12, ¿qué acción se debe realizar obligatoriamente ANTES de que un visitante entregue su arma para custodia?',
                    options: [ { text: 'Verificar el permiso de porte.', correct: false }, { text: 'Realizar el manejo de seguridad en el tubo de descargue.', correct: true }, { text: 'Limpiar el arma.', correct: false } ],
                    feedbackCorrect: '¡Correcto! El protocolo E-12 (Acceso Peatonal, punto 6 y Control Armas) menciona explícitamente realizar los manejos de seguridad en el tubo de descargue antes de la custodia.',
                    feedbackIncorrect: 'Incorrecto. Si bien verificar el permiso puede ser parte de otro procedimiento, el protocolo E-12 enfatiza el manejo seguro en el tubo de descargue antes de la custodia.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Taser Personal', icon: '<span>&#128104;&#8205;&#128110;</span><span class="mx-2">&#9889;</span><span>&#128274;</span>', color: 'text-yellow-600', text: 'Un patrullero de la estación, que no está de servicio, ingresa a las instalaciones portando una pistola Taser de su propiedad. ¿Puede ingresarla?', options: [ { id: 'a', text: '(a) Sí, porque es funcionario de la estación.' }, { id: 'b', text: '(b) Sí, porque las Taser no son armas de fuego.' }, { id: 'c', text: '(c) No, el protocolo prohíbe el ingreso de armas (incluye Taser) y debe dejarla en custodia en el armerillo transitorio.' }, { id: 'd', text: '(d) Solo si la va a usar para un procedimiento inmediato.' } ], correctAnswer: 'c', feedback: { 'a': "Incorrecto. La prohibición aplica incluso al personal de planta fuera de servicio.", 'b': "Incorrecto. El protocolo E-12 menciona explícitamente Taser junto a armas de fuego como prohibidas para ingreso.", 'c': "¡Correcto! El protocolo E-12 (Acceso Peatonal, punto 20 y Control Armas) indica que armas de fuego, Taser y explosivos deben reposar en el armerillo transitorio.", 'd': "Incorrecto. Si estuviera en servicio y asignada, sería diferente, pero no para ingreso personal." } },
                     { id: 2, title: 'Escenario 2: Olvido de Ficha', icon: '<span>&#128299;</span><span class="mx-2">&#127915;</span><span>&#10067;</span>', color: 'text-orange-600', text: 'Un visitante dejó su arma en custodia al ingresar. Al salir, reclama su arma pero ha perdido la ficha que se le entregó. ¿Cómo procede el personal del armerillo transitorio?', options: [ { id: 'a', text: '(a) Entregarle el arma confiando en su palabra.' }, { id: 'b', text: '(b) Negarse a entregar el arma hasta que encuentre la ficha.' }, { id: 'c', text: '(c) Verificar exhaustivamente la identidad del visitante y el registro de ingreso del arma en el sistema/libro. Si todo coincide, proceder a la entrega dejando constancia escrita de la pérdida de la ficha y la verificación realizada.' }, { id: 'd', text: '(d) Llamar al Comandante para que autorice la entrega.' } ], correctAnswer: 'c', feedback: { 'a': "Incorrecto. Entregar un arma sin la debida verificación es un riesgo grave.", 'b': "Incorrecto. Negarse completamente puede generar un problema mayor. Se debe buscar una solución segura.", 'c': "¡Correcto! Ante la pérdida de la ficha, se debe realizar una verificación rigurosa de identidad y del registro original. Documentar la entrega y la pérdida de la ficha es fundamental.", 'd': "Incorrecto. El personal del armerillo debe tener un procedimiento para estos casos; solo se escalaría si la verificación no es satisfactoria." } }
                ],
                 summaryPoints: [ 'El porte de armas (fuego, taser, etc.) está <strong>prohibido</strong> dentro de la E-12 (E-12).', 'Existen <strong>excepciones limitadas</strong> (seguridad local, entrega servicio, 1 escolta visita) (E-12).', 'Obligatorio usar <strong>tubo de descargue</strong> antes de la custodia (E-12).', 'Se debe usar <strong>armerillo transitorio</strong> y <strong>registrar</strong> toda arma en SICOVI/libro (E-12).', 'Entregar <strong>ficha de custodia</strong> al propietario (E-12).' ]
            },
             // --- MÓDULO 7: PERSONAS DETENIDAS ---
             // Este módulo se basa en el Art. 51 de la Res. 01675 y la sección "CAPTURADOS" del protocolo E-12
            {
                id: 'detenidos',
                title: 'Ingreso Personas Capturadas',
                menuIcon: svgIcons.peaton, // Reusar icono, tal vez añadir esposas?
                subtitle: 'Protocolo E-12 y Art. 51 (Res. 01675)',
                protocolSteps: [
                    { title: 'Paso 1: Propósito y Custodia', icon: '<span>&#128110;</span><span class="mx-2">&#128272;</span><span>&#128064;</span>', color: 'text-blue-500', points: ['Ingreso EXCLUSIVO para diligencias de judicialización.', 'SIEMPRE custodiados por funcionarios responsables.', 'Minimizar probabilidad de fuga, autoagresión o ataque a terceros.'] },
                    { title: 'Paso 2: Medidas de Seguridad Físicas', icon: '<span>&#128272;</span><span class="mx-2">&#128070;</span><span>&#128071;</span>', color: 'text-red-600', points: ['Ingresar DEBIDAMENTE esposados.', 'Brazos atrás.'] },
                    { title: 'Paso 3: Registro Detallado (E-12)', icon: '<span>&#128211;</span><span class="mx-2">&#128100;</span><span>&#129309;</span>', color: 'text-orange-500', points: ['Realizar anotación en Libro de Población (Grupo Seguridad / Cte Guardia).', 'Datos de la persona.', 'Motivo del ingreso.', 'Estado y condiciones físicas.', 'Datos personales del responsable de la custodia.'] },
                    { title: 'Paso 4: Unidades de Apoyo (E-12)', icon: '<span>&#128104;&#8205;&#128110;</span><span class="mx-2">&#128218;</span><span>🤝</span>', color: 'text-green-500', points: ['Si son unidades de apoyo/especialidades quienes traen al capturado:', 'Deben acoplarse y acatar el protocolo de seguridad de la E-12.', 'Asegurar custodia permanente por los funcionarios encargados.', 'Realizar registro completo en Libro de Población.'] }
                ],
                 verificationQuestion: {
                    text: '¿Cuál es el propósito EXCLUSIVO para el ingreso de capturados a la E-12 según su protocolo?',
                    options: [ { text: 'Alojamiento temporal.', correct: false }, { text: 'Realizar diligencias dentro de la actividad de judicialización.', correct: true }, { text: 'Entrevistas con abogados.', correct: false } ],
                    feedbackCorrect: '¡Correcto! El protocolo E-12 es claro: el ingreso es solo para diligencias de judicialización.',
                    feedbackIncorrect: 'Incorrecto. Revisa la sección "CAPTURADOS" del protocolo E-12. El propósito es específico.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Ingreso sin Esposas', icon: '<span>&#128100;</span><span class="mx-2">&#128272;</span><span>&#10060;</span>', color: 'text-red-600', text: 'Una patrulla ingresa con un capturado por hurto que parece tranquilo y no lo traen esposado para "evitar incomodarlo". ¿Es correcto?', options: [ { id: 'a', text: '(a) Sí, si la persona está colaborando.' }, { id: 'b', text: '(b) No, el protocolo exige ingresar DEBIDAMENTE esposado con brazos atrás, independientemente de su actitud.' }, { id: 'c', text: '(c) Solo se esposa si es delito grave.' }, { id: 'd', text: '(d) Depende de la decisión del comandante de patrulla.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. La actitud puede cambiar; el protocolo es una medida preventiva estándar.", 'b': "¡Correcto! El protocolo E-12 (sección Capturados) y el Art. 51 exigen el ingreso esposado con brazos atrás como medida de seguridad.", 'c': "Incorrecto. El protocolo no distingue por tipo de delito para esta medida.", 'd': "Incorrecto. El protocolo prima sobre la decisión individual en este aspecto." } },
                     { id: 2, title: 'Escenario 2: Falta Registro Custodio', icon: '<span>&#128211;</span><span class="mx-2">&#128110;</span><span>&#10067;</span>', color: 'text-yellow-600', text: 'Personal de SIJIN ingresa con un capturado para una reseña. Se registra al capturado en el Libro de Población, pero se omite anotar quiénes son los funcionarios de SIJIN responsables de la custodia. ¿Qué falta en el procedimiento?', options: [ { id: 'a', text: '(a) Nada, ya se registró al capturado.' }, { id: 'b', text: '(b) Falta registrar el estado físico del capturado.' }, { id: 'c', text: '(c) Falta registrar los datos personales de los funcionarios responsables de la custodia.' }, { id: 'd', text: '(d) Falta registrar el motivo del ingreso.' } ], correctAnswer: 'c', feedback: { 'a': "Incorrecto. El registro debe ser completo.", 'b': "Incorrecto. Si bien el estado físico también se registra, la omisión específica aquí es el custodio.", 'c': "¡Correcto! El protocolo E-12 (sección Capturados) y el Art. 51 exigen registrar los datos personales del responsable de la custodia.", 'd': "Incorrecto. El motivo también se registra, pero la pregunta se enfoca en la omisión respecto al custodio." } }
                ],
                 summaryPoints: [ 'Ingreso de capturados es solo para <strong>diligencias de judicialización</strong> (E-12).', 'Deben ingresar <strong>esposados con brazos atrás</strong> (E-12, Art. 51).', '<strong>Custodia permanente</strong> por funcionarios responsables es vital (E-12, Art. 51).', '<strong>Registro detallado</strong> en Libro de Población (incluye datos PPL, motivo, estado físico y datos del CUSTODIO) es obligatorio (E-12, Art. 51).' ]
            },
             // --- MÓDULO 8: PARQUEADERO ---
            {
                id: 'parqueadero',
                title: 'Control de Parqueadero',
                menuIcon: svgIcons.parqueadero,
                subtitle: 'Protocolo Específico E-12 (Similar Art. 52)',
                protocolSteps: [
                    { title: 'Paso 1: Distribución y Demarcación', icon: '<span>🅿️</span><span class="mx-2">&#128663;</span><span>&#128207;</span>', color: 'text-blue-500', points: ['Distribuir espacios: institucionales, funcionarios, visitas especiales, discapacidad/movilidad reducida.', 'Enumerar y demarcar espacios.', 'Ayuda a control y asignación de ficheros.'] },
                    { title: 'Paso 2: Personal de Seguridad y Control', icon: '<span>&#128110;</span><span class="mx-2">&#127915;</span><span>&#128064;</span>', color: 'text-green-500', points: ['Contar con personal de seguridad.', 'Funciones: Controlar parqueo en lugar asignado, verificar ficha visible.', 'Verificar a 19:00 hrs retiro vehículos particulares no autorizados a pernoctar (salvo excepciones laborales/gestión).'] },
                    { title: 'Paso 3: Registros y Ficheros (E-12)', icon: '<span>&#128214;</span><span class="mx-2">&#128196;</span><span>&#127915;</span>', color: 'text-orange-500', points: ['Funcionarios autorizados deben allegar documentación vigente para base de datos.', 'Base de datos actualizada (propietario/conductor, contacto, placa, marca, tipo, etc.).', 'Ficheros actualizados y de uso obligatorio (porte visible en vehículo).'] },
                    { title: 'Paso 4: Normas de Permanencia y Circulación', icon: '<span>&#128681;</span><span class="mx-2">&#128285;</span><span>&#128694;</span>', color: 'text-red-500', points: ['Vehículos NO institucionales NO pueden pernoctar.', 'Vehículos autorizados deben ocupar número asignado.', 'Velocidad máxima: 10 km/h.', 'Buena iluminación y zonas peatonales demarcadas.'] },
                    { title: 'Paso 5: Seguridad Adicional', icon: '<span>&#128021;</span><span class="mx-2">&#128247;</span><span>&#128142;</span>', color: 'text-purple-500', points: ['Prohibido dejar objetos de valor visibles.', 'Inspecciones periódicas con binomios antiexplosivos (si hay).', 'Recomendable: Contar con CCTV.'] }
                ],
                 verificationQuestion: {
                    text: 'Según el protocolo E-12, ¿es obligatorio que los vehículos autorizados porten la ficha de parqueadero visible?',
                    options: [ { text: 'No, solo deben tenerla.', correct: false }, { text: 'Sí, el porte visible es obligatorio.', correct: true }, { text: 'Solo para visitantes.', correct: false } ],
                    feedbackCorrect: '¡Correcto! El protocolo E-12 (Parqueadero, punto 3b y 5) indica que la ficha debe estar visible y su porte es obligatorio.',
                    feedbackIncorrect: 'Incorrecto. Revisa el protocolo E-12 (Parqueadero, punto 3b y 5). Se exige el porte visible de la ficha.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Cambio de Puesto', icon: '<span>🅿️</span><span class="mx-2">&#128663;</span><span>&#11021;</span>', color: 'text-yellow-600', text: 'Un funcionario con parqueadero asignado (N° 15) decide estacionar en otro número (N° 20) porque le queda más cerca de la salida. ¿Es esto permitido?', options: [ { id: 'a', text: '(a) Sí, si el puesto 20 estaba libre.' }, { id: 'b', text: '(b) No, el protocolo E-12 (Parqueadero, punto 7) indica que deben ocupar el número de parqueadero correspondiente asignado.' }, { id: 'c', text: '(c) Solo si informa al personal de seguridad.' }, { id: 'd', text: '(d) Sí, mientras sea dentro de la zona de funcionarios.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. La disponibilidad no anula la asignación.", 'b': "¡Correcto! El protocolo E-12 (Parqueadero, punto 7) es específico en que se debe ocupar el puesto asignado.", 'c': "Incorrecto. Informar no cambia la norma de ocupar el puesto asignado.", 'd': "Incorrecto. La asignación es por número específico, no solo por zona." } },
                     { id: 2, title: 'Escenario 2: Objeto de Valor', icon: '<span>&#128187;</span><span class="mx-2">&#128663;</span><span>&#128064;</span>', color: 'text-purple-600', text: 'Un visitante deja su computador portátil visible en el asiento del copiloto al estacionar en el parqueadero asignado. ¿Qué recomendación debería darle el personal de seguridad?', options: [ { id: 'a', text: '(a) Ninguna, es responsabilidad del visitante.' }, { id: 'b', text: '(b) Recomendarle que no deje objetos de valor visibles dentro del vehículo, ya que la unidad no se hace responsable por pérdidas o daños.' }, { id: 'c', text: '(c) Ofrecerle guardarle el portátil en la oficina de seguridad.' }, { id: 'd', text: '(d) Decirle que el parqueadero es muy seguro y no hay problema.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto. Si bien la responsabilidad final es del dueño, el protocolo incluye la recomendación preventiva.", 'b': "¡Correcto! El protocolo E-12 (Parqueadero, punto 9) prohíbe dejar objetos de valor y exime de responsabilidad a la unidad, por lo que la recomendación es pertinente.", 'c': "Incorrecto. El personal de seguridad no debe asumir la custodia de objetos personales de valor de los visitantes.", 'd': "Incorrecto. No se deben dar falsas seguridades; la recomendación es no dejar objetos visibles." } }
                ],
                 summaryPoints: [ 'La <strong>distribución y demarcación</strong> facilitan el control (E-12).', 'El personal de seguridad verifica <strong>parqueo asignado</strong> y <strong>ficha visible</strong> (E-12).', 'Se requiere <strong>base de datos actualizada</strong> y <strong>ficheros obligatorios</strong> (E-12).', 'Prohibida la <strong>pernocta no autorizada</strong> y se debe respetar el <strong>puesto asignado</strong> (E-12).', 'Recordar <strong>no dejar objetos de valor</strong> y seguir normas de circulación (E-12).' ]
            },
             // --- MÓDULO 9: CORRESPONDENCIA Y PAQUETES ---
             {
                id: 'correspondencia',
                title: 'Control Correspondencia/Paquetes',
                menuIcon: svgIcons.paquete,
                subtitle: 'Protocolo Específico E-12',
                protocolSteps: [
                    { title: 'Paso 1: Recepción Directa', icon: '<span>&#128232;</span><span class="mx-2">&#128100;</span><span>&#10060;</span>', color: 'text-blue-500', points: ['Correspondencia/paquetes deben ser recepcionados DIRECTAMENTE por el funcionario destinatario.', 'Personal de seguridad NO debe recibir elementos para terceros.', 'NO se permite almacenar correspondencia/paquetes de uso personal en la guardia/recepción.'] },
                    { title: 'Paso 2: Revisión Obligatoria', icon: '<span>&#128270;</span><span class="mx-2">&#128230;</span><span>&#9888;&#65039;</span>', color: 'text-orange-500', points: ['Los paquetes DEBERÁN ser revisados (por el destinatario o seguridad si aplica) para evitar atentados.', 'Aplicar protocolos de elementos sospechosos si es necesario.'] }
                ],
                 verificationQuestion: {
                    text: '¿Puede el personal de seguridad de la guardia recibir un paquete dirigido a un funcionario que no se encuentra en la unidad en ese momento?',
                    options: [ { text: 'Sí, para guardárselo.', correct: false }, { text: 'No, el protocolo E-12 indica que debe ser recepcionado directamente por el destinatario.', correct: true }, { text: 'Solo si el paquete no es muy grande.', correct: false } ],
                    feedbackCorrect: '¡Correcto! El protocolo E-12 es claro: la recepción es directa por el destinatario, seguridad no recibe para terceros.',
                    feedbackIncorrect: 'Incorrecto. Revisa el protocolo E-12 sobre correspondencia. La recepción es directa por el destinatario.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Paquete Sospechoso', icon: '<span>&#128230;</span><span class="mx-2">&#128064;</span><span>&#128163;</span>', color: 'text-red-600', text: 'Llega un mensajero con un paquete sin remitente claro, dirigido genéricamente a "Comando Estación". El paquete presenta manchas aceitosas y un olor extraño. ¿Qué debe hacer el personal de seguridad?', options: [ { id: 'a', text: '(a) Recibirlo y dejarlo en la oficina del Comandante.' }, { id: 'b', text: '(b) No recibirlo y devolverlo con el mensajero.' }, { id: 'c', text: '(c) NO recibirlo directamente. Aislar el área si es posible, no manipular el paquete, informar inmediatamente al superior y solicitar apoyo especializado (antedex/NBQR) para verificarlo antes de cualquier manipulación.' }, { id: 'd', text: '(d) Abrirlo cuidadosamente para ver qué contiene.' } ], correctAnswer: 'c', feedback: { 'a': "Incorrecto. Recibir un paquete sospechoso es un riesgo grave.", 'b': "Incorrecto. Devolverlo podría no ser seguro y se pierde la oportunidad de análisis si es una amenaza real.", 'c': "¡Correcto! Ante un paquete sospechoso (sin remitente, manchas, olor), se deben aplicar los protocolos de seguridad para elementos peligrosos: no tocar, aislar, informar y solicitar apoyo especializado.", 'd': "¡Muy Incorrecto! Nunca se debe abrir un paquete sospechoso." } }
                ],
                 summaryPoints: [ 'La correspondencia/paquetes se entregan <strong>directamente al destinatario</strong> (E-12).', 'El personal de seguridad <strong>NO recibe</strong> paquetes para terceros (E-12).', '<strong>No se almacena</strong> correspondencia/paquetes personales en recepción (E-12).', 'Los paquetes deben ser <strong>revisados</strong> para prevenir riesgos (E-12).' ]
            },
             // --- MÓDULO 10: COMPORTAMIENTO ALOJAMIENTO ---
             {
                id: 'alojamiento',
                title: 'Comportamiento Alojamiento',
                menuIcon: svgIcons.alojamiento,
                subtitle: 'Protocolo Específico E-12',
                protocolSteps: [
                    { title: 'Paso 1: Orden y Aseo', icon: '<span>&#128719;️</span><span class="mx-2">&#129529;</span><span>✨</span>', color: 'text-blue-500', points: ['Realizar y preservar aseo (perfecto estado, orden, higiene).', 'Elementos asignados marcados con copia carné.', 'Buen uso de elementos; daños deben subsanarse.', 'Camas tendidas, unificar color, no elementos visibles fuera de cómodas.', 'No tendederos improvisados.', 'Baños limpios y secos; mesura con agua; separar residuos.'] },
                    { title: 'Paso 2: Prohibiciones Generales', icon: '<span>&#128683;</span><span class="mx-2">&#127867;</span><span>🚬</span>', color: 'text-red-600', points: ['Prohibido ingreso personal ajeno sin autorización Cte E-12 / Jefe Seguridad.', 'Prohibido ingreso mujeres/hombres (según corresponda) a habitaciones (expulsión/informe).', 'Prohibido festejos, fiestas, reuniones.', 'Prohibido almacenar/consumir bebidas embriagantes/sustancias alucinógenas.', 'Prohibido fumar.', 'Prohibido almacenar/tener armamento/munición/explosivos.', 'Prohibido música a alto volumen.', 'Prohibido almacenar/consumir alimentos (solo áreas autorizadas).', 'No acumular basuras.'] },
                    { title: 'Paso 3: Convivencia y Descanso', icon: '<span>🤫</span><span class="mx-2">&#128164;</span><span>🤝</span>', color: 'text-green-500', points: ['Respetar tranquilidad y descanso de compañeros.', 'No ingresar en estado de embriaguez/bajo efectos sustancias.'] },
                    { title: 'Paso 4: Responsabilidad y Salida', icon: '<span>🔑</span><span class="mx-2">&#128230;</span><span>&#128110;</span>', color: 'text-orange-500', points: ['Hurto = Judicialización/Informe.', 'Al salir (traslado, etc.): Entregar elementos a logística/Oficial/Suboficial de Servicio, entregar llaves.'] }
                ],
                 verificationQuestion: {
                    text: '¿Se permite consumir alimentos dentro de las habitaciones del alojamiento según el protocolo E-12?',
                    options: [ { text: 'Sí, si se mantiene limpio.', correct: false }, { text: 'Solo bebidas, no comidas.', correct: false }, { text: 'No, está prohibido; debe hacerse en las áreas autorizadas.', correct: true } ],
                    feedbackCorrect: '¡Correcto! El protocolo E-12 (Alojamiento, punto 18) prohíbe explícitamente consumir alimentos en los alojamientos.',
                    feedbackIncorrect: 'Incorrecto. Revisa el protocolo E-12 (Alojamiento, punto 18). El consumo de alimentos está restringido a las áreas designadas.'
                },
                scenarios: [
                     { id: 1, title: 'Escenario 1: Fiesta en Habitación', icon: '<span>🎉</span><span class="mx-2">&#127925;</span><span>&#10060;</span>', color: 'text-red-600', text: 'Escucha música a alto volumen y risas provenientes de una habitación del alojamiento un viernes por la noche. Al verificar, encuentra a varios funcionarios reunidos consumiendo bebidas embriagantes. ¿Qué indica el protocolo E-12?', options: [ { id: 'a', text: '(a) Unirse a la celebración si lo invitan.' }, { id: 'b', text: '(b) Pedirles que bajen el volumen de la música.' }, { id: 'c', text: '(c) Que está prohibido realizar festejos, consumir bebidas embriagantes y poner música a alto volumen. Se debe informar la novedad al superior.' }, { id: 'd', text: '(d) Ignorarlo si no están causando problemas mayores.' } ], correctAnswer: 'c', feedback: { 'a': "Incorrecto.", 'b': "Incorrecto. Bajar el volumen no soluciona las otras prohibiciones.", 'c': "¡Correcto! El protocolo E-12 (Alojamiento) prohíbe reuniones/festejos (6), consumo de alcohol (7) y música alta (11). La novedad debe ser informada.", 'd': "Incorrecto. Se están incumpliendo varias normas del régimen interno." } },
                     { id: 2, title: 'Escenario 2: Cama Desordenada', icon: '<span>🛏️</span><span class="mx-2">&#128095;</span><span>🧺</span>', color: 'text-yellow-600', text: 'Durante una revista al alojamiento, el Suboficial de Servicio encuentra una cama des-tendida con ropa y toallas encima. ¿Qué norma del protocolo E-12 se está incumpliendo?', options: [ { id: 'a', text: '(a) La prohibición de fumar.' }, { id: 'b', text: '(b) La norma sobre orden, aseo y elementos visibles fuera de las cómodas.' }, { id: 'c', text: '(c) La prohibición de consumir alimentos.' }, { id: 'd', text: '(d) La norma sobre respeto al descanso.' } ], correctAnswer: 'b', feedback: { 'a': "Incorrecto.", 'b': "¡Correcto! El protocolo E-12 (Alojamiento, puntos 1, 14 y 15) exige orden, aseo, camas tendidas y que no haya elementos visibles fuera de las cómodas.", 'c': "Incorrecto.", 'd': "Incorrecto." } }
                ],
                 summaryPoints: [ 'Mantener <strong>orden y aseo</strong> impecable es fundamental (E-12).', 'Existen múltiples <strong>prohibiciones</strong>: visitas no autorizadas, alcohol/drogas, armas, fiestas, fumar, alimentos en habitación (E-12).', 'Respetar el <strong>descanso</strong> y la <strong>tranquilidad</strong> de los compañeros (E-12).', 'El <strong>hurto</strong> tiene consecuencias graves (E-12).', 'Al salir de la unidad, se debe <strong>entregar todo</strong> en orden (E-12).' ]
            }
        ];

        // --- Lógica de la Aplicación (sin cambios significativos, adaptada a nueva estructura) ---
        let currentModuleId = null;
        let currentStep = 1;
        let currentScenario = 1;
        let currentModuleData = {};

        // Funciones auxiliares (sin cambios)
        function showElement(id) { const el = document.getElementById(id); if (el) el.style.display = 'block'; }
        function hideElement(id) { const el = document.getElementById(id); if (el) el.style.display = 'none'; }
        function clearContainer(containerId) { const container = document.getElementById(containerId); if (container) container.innerHTML = ''; }

        // Inicialización del Menú Principal (Adaptada a Cards)
        function initializeMainMenu() {
            const menuContainer = document.getElementById('menu-cards-container');
            clearContainer('menu-cards-container');
            modulesData.forEach(module => {
                const card = document.createElement('div');
                card.className = 'menu-card';
                card.onclick = () => loadModule(module.id);
                card.innerHTML = `
                    <div class="menu-card-icon">${module.menuIcon || '❓'}</div>
                    <h3 class="menu-card-title">${module.title}</h3>
                    <p class="menu-card-subtitle">${module.subtitle}</p>
                `;
                menuContainer.appendChild(card);
            });
            showElement('main-menu');
            hideElement('active-module');
        }

        // Cargar un Módulo (Adaptada para resetear botón volver)
        function loadModule(moduleId) {
            currentModuleId = moduleId;
            currentModuleData = modulesData.find(m => m.id === moduleId);
            if (!currentModuleData) return;

            hideElement('main-menu');
            showElement('active-module');
            hideElement('protocolo');
            hideElement('escenarios');
            hideElement('resumen');
            hideElement('verification-question');

            document.getElementById('module-title').textContent = currentModuleData.title;
            document.getElementById('module-subtitle').textContent = currentModuleData.subtitle;

            buildProtocolSection();
            buildScenariosSection();
            buildSummarySection();

            showElement('protocolo');
            currentStep = 1;
            setActiveStep(currentStep);
        }

        // Construir Sección de Protocolo (Adaptada para botones nav)
        function buildProtocolSection() {
            const stepsContainer = document.getElementById('protocol-steps-container');
            clearContainer('protocol-steps-container');
            const totalSteps = currentModuleData.protocolSteps.length;

            currentModuleData.protocolSteps.forEach((step, index) => {
                const stepNumber = index + 1;
                const stepDiv = document.createElement('div');
                stepDiv.id = `step-${stepNumber}`;
                stepDiv.className = 'step-content mb-6 p-5 border rounded-lg bg-gray-50 shadow-sm'; // Añadido padding y sombra

                stepDiv.innerHTML = `
                    <h4 class="font-semibold text-lg mb-3 text-gray-700 flex items-center">
                       <span class="text-2xl mr-3 ${step.color || 'text-gray-500'}">${step.icon || ''}</span>
                       ${step.title}
                    </h4>
                    <ul class="list-disc list-inside text-gray-600 space-y-1 text-sm">
                        ${step.points.map(p => `<li>${p}</li>`).join('')}
                    </ul>
                    <div class="mt-6 flex justify-between">
                        <button onclick="prevStep(${stepNumber - 1})" class="nav-button secondary ${stepNumber === 1 ? 'invisible' : ''}">Anterior</button>
                        ${stepNumber === totalSteps
                            ? `<button onclick="showVerificationQuestion()" class="nav-button success">Verificar Comprensión</button>`
                            : `<button onclick="nextStep(${stepNumber + 1})" class="nav-button primary">Siguiente</button>`
                        }
                    </div>
                `;
                stepsContainer.appendChild(stepDiv);
            });

            // Construir pregunta de verificación (sin cambios estructurales)
            const vq = currentModuleData.verificationQuestion;
            document.getElementById('verification-question-text').textContent = vq.text;
            const vqOptionsContainer = document.getElementById('verification-options-container');
            clearContainer('verification-options-container');
            vq.options.forEach(opt => {
                const button = document.createElement('button');
                button.className = 'option-button';
                button.textContent = opt.text;
                button.onclick = () => checkVerificationAnswer(opt.correct, button);
                vqOptionsContainer.appendChild(button);
            });
            const vqFeedback = document.getElementById('verification-feedback');
            vqFeedback.style.display = 'none'; vqFeedback.textContent = ''; vqFeedback.className = 'feedback';
            document.getElementById('start-scenarios-btn').style.display = 'none';
        }

        // Construir Sección de Escenarios (Adaptada para botones nav)
        function buildScenariosSection() {
            const scenariosContainer = document.getElementById('scenarios-container');
            clearContainer('scenarios-container');
            if (!currentModuleData.scenarios || currentModuleData.scenarios.length === 0) {
                 scenariosContainer.innerHTML = '<p class="text-gray-500 text-center italic my-6">No hay escenarios de práctica disponibles para este módulo.</p>';
                 setTimeout(showSummary, 1500);
                return;
            }
            const totalScenarios = currentModuleData.scenarios.length;

            currentModuleData.scenarios.forEach((scenario, index) => {
                const scenarioNumber = index + 1;
                const scenarioDiv = document.createElement('div');
                scenarioDiv.id = `scenario-${scenarioNumber}`;
                scenarioDiv.className = 'scenario-content p-5 border rounded-lg bg-gray-50 mb-6 shadow-sm'; // Añadido padding y sombra

                scenarioDiv.innerHTML = `
                    <h4 class="font-semibold text-lg mb-3 text-gray-700 flex items-center">
                        <span class="text-2xl mr-3 ${scenario.color || 'text-gray-500'}">${scenario.icon || ''}</span>
                        ${scenario.title}
                    </h4>
                    <p class="text-gray-600 mb-4 text-sm">${scenario.text}</p>
                    <div id="options-scenario-${scenarioNumber}">
                        ${scenario.options.map(opt => `<button class="option-button" onclick="checkScenarioAnswer(${scenarioNumber}, '${opt.id}', this)">${opt.text}</button>`).join('')}
                    </div>
                    <div id="feedback-scenario-${scenarioNumber}" class="feedback"></div>
                    <div class="mt-6 text-right">
                        ${scenarioNumber === totalScenarios
                            ? `<button id="next-scenario-${scenarioNumber}" onclick="showSummary()" style="display:none;" class="nav-button success">Ver Resumen</button>`
                            : `<button id="next-scenario-${scenarioNumber}" onclick="nextScenario(${scenarioNumber + 1})" style="display:none;" class="nav-button primary">Siguiente Escenario</button>`
                        }
                    </div>
                `;
                scenariosContainer.appendChild(scenarioDiv);
                const feedbackEl = document.getElementById(`feedback-scenario-${scenarioNumber}`);
                feedbackEl.style.display = 'none'; feedbackEl.textContent = ''; feedbackEl.className = 'feedback';
                const nextButton = document.getElementById(`next-scenario-${scenarioNumber}`);
                if(nextButton) nextButton.style.display = 'none';
            });
        }

        // Construir Sección de Resumen (sin cambios estructurales)
        function buildSummarySection() {
            const summaryPointsList = document.getElementById('summary-points');
            clearContainer('summary-points');
             if (!currentModuleData.summaryPoints || currentModuleData.summaryPoints.length === 0) {
                 summaryPointsList.innerHTML = '<li class="text-gray-500 italic">Resumen no disponible.</li>';
                 return;
             }
            currentModuleData.summaryPoints.forEach(point => {
                const li = document.createElement('li');
                li.innerHTML = point;
                summaryPointsList.appendChild(li);
            });
        }

        // --- Funciones de Navegación y Lógica (sin cambios funcionales) ---
        function setActiveStep(stepNumber) { document.querySelectorAll(`#protocol-steps-container .step-content`).forEach(el => el.classList.remove('active')); const el = document.getElementById(`step-${stepNumber}`); if (el) el.classList.add('active'); }
        function nextStep(stepNumber) { const totalSteps = currentModuleData.protocolSteps.length; if (stepNumber <= totalSteps) { currentStep = stepNumber; setActiveStep(currentStep); } }
        function prevStep(stepNumber) { if (stepNumber >= 1) { currentStep = stepNumber; setActiveStep(currentStep); } }

        function showVerificationQuestion() {
            const totalSteps = currentModuleData.protocolSteps.length;
            hideElement(`step-${totalSteps}`); showElement('verification-question');
            const vqOptionsContainer = document.getElementById('verification-options-container');
            vqOptionsContainer.querySelectorAll('.option-button').forEach(btn => { btn.disabled = false; btn.className = 'option-button'; });
            hideElement('verification-feedback'); hideElement('start-scenarios-btn');
        }

        function checkVerificationAnswer(isCorrect, buttonElement) {
            const feedbackEl = document.getElementById('verification-feedback');
            const allButtons = document.querySelectorAll('#verification-options-container .option-button');
            const vq = currentModuleData.verificationQuestion;
            allButtons.forEach(btn => { btn.disabled = true; btn.classList.remove('selected', 'correct-answer', 'incorrect-answer'); }); // Limpiar clases antes
            buttonElement.classList.add('selected');
            if (isCorrect) {
                feedbackEl.textContent = vq.feedbackCorrect; feedbackEl.className = 'feedback correct'; showElement('start-scenarios-btn'); buttonElement.classList.add('correct-answer');
            } else {
                feedbackEl.textContent = vq.feedbackIncorrect; feedbackEl.className = 'feedback incorrect';
                allButtons.forEach(btn => { const opt = vq.options.find(o => o.text === btn.textContent); if (opt && opt.correct) btn.classList.add('correct-answer'); });
                buttonElement.classList.add('incorrect-answer');
            }
            feedbackEl.style.display = 'block';
        }

        function startScenarios() {
             if (!currentModuleData.scenarios || currentModuleData.scenarios.length === 0) { hideElement('protocolo'); showSummary(); }
             else { hideElement('protocolo'); showElement('escenarios'); currentScenario = 1; setActiveScenario(currentScenario); }
        }

        function setActiveScenario(scenarioNumber) {
            document.querySelectorAll(`#scenarios-container .scenario-content`).forEach(el => el.classList.remove('active'));
            const el = document.getElementById(`scenario-${scenarioNumber}`);
            if (el) {
                el.classList.add('active');
                el.querySelectorAll('.option-button').forEach(btn => { btn.disabled = false; btn.className = 'option-button'; });
                const fb = document.getElementById(`feedback-scenario-${scenarioNumber}`); if(fb) fb.style.display = 'none';
                const nb = document.getElementById(`next-scenario-${scenarioNumber}`); if(nb) nb.style.display = 'none';
            }
        }

        function checkScenarioAnswer(scenarioNum, selectedOptionId, buttonElement) {
            const scenarioData = currentModuleData.scenarios.find(s => s.id === scenarioNum); if (!scenarioData) return;
            const correctAnswerId = scenarioData.correctAnswer; const feedback = scenarioData.feedback[selectedOptionId];
            const feedbackEl = document.getElementById(`feedback-scenario-${scenarioNum}`);
            const nextButton = document.getElementById(`next-scenario-${scenarioNum}`);
            const allButtons = document.querySelectorAll(`#scenario-${scenarioNum} .option-button`);
            allButtons.forEach(btn => { btn.disabled = true; btn.classList.remove('selected', 'correct-answer', 'incorrect-answer'); }); // Limpiar clases antes
            buttonElement.classList.add('selected'); feedbackEl.textContent = feedback;
            if (selectedOptionId === correctAnswerId) {
                feedbackEl.className = 'feedback correct'; buttonElement.classList.add('correct-answer');
            } else {
                feedbackEl.className = 'feedback incorrect'; buttonElement.classList.add('incorrect-answer');
                allButtons.forEach(btn => { const opt = scenarioData.options.find(o => o.id === correctAnswerId); if (opt && btn.textContent === opt.text) btn.classList.add('correct-answer'); });
            }
            feedbackEl.style.display = 'block'; if (nextButton) { nextButton.style.display = 'inline-block'; }
        }

        function nextScenario(scenarioNumber) { const totalScenarios = currentModuleData.scenarios.length; if (scenarioNumber <= totalScenarios) { currentScenario = scenarioNumber; setActiveScenario(currentScenario); } }
        function showSummary() { hideElement('escenarios'); hideElement('protocolo'); showElement('resumen'); }
        function restartCurrentModule() { if(currentModuleId) { loadModule(currentModuleId); } }
        function goToMainMenu() { hideElement('active-module'); showElement('main-menu'); currentModuleId = null; currentModuleData = {}; initializeMainMenu(); }

        // Inicializar al cargar la página
        document.addEventListener('DOMContentLoaded', initializeMainMenu);
    </script>

</body>
</html>
